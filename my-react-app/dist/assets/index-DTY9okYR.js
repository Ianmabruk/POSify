var st=Object.defineProperty;var at=(t,p,n)=>p in t?st(t,p,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[p]=n;var Ue=(t,p,n)=>at(t,typeof p!="symbol"?p+"":p,n);import{r as c,a as lt,u as Q,b as rt,R as Me,c as F,B as nt,N as W,d as it}from"./vendor-DvzhpQQn.js";import{S as ct,A as ne,P as ot,C as je,a as V,L as Be,T as ee,U as de,b as He,Z as Ke,c as ze,d as Y,X as Ce,e as G,f as he,M as ye,g as Ne,D as ae,h as Je,i as _e,j as Pe,k as H,l as dt,m as xt,n as Ge,o as ue,p as K,q as mt,r as ht,s as Ae,t as xe,u as Te,v as te,B as Ie,I as ut,w as ve,x as se,y as we,z as pt,E as gt,F as We,G as bt,H as oe,J as ge,K as ft,N as jt,O as yt,Q as Nt,R as vt}from"./icons-DZ1ohuYB.js";(function(){const p=document.createElement("link").relList;if(p&&p.supports&&p.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))m(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&m(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function m(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();var Ve={exports:{}},pe={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wt=c,St=Symbol.for("react.element"),kt=Symbol.for("react.fragment"),Ct=Object.prototype.hasOwnProperty,Pt=wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,At={key:!0,ref:!0,__self:!0,__source:!0};function Ye(t,p,n){var m,r={},o=null,a=null;n!==void 0&&(o=""+n),p.key!==void 0&&(o=""+p.key),p.ref!==void 0&&(a=p.ref);for(m in p)Ct.call(p,m)&&!At.hasOwnProperty(m)&&(r[m]=p[m]);if(t&&t.defaultProps)for(m in p=t.defaultProps,p)r[m]===void 0&&(r[m]=p[m]);return{$$typeof:St,type:t,key:o,ref:a,props:r,_owner:Pt.current}}pe.Fragment=kt;pe.jsx=Ye;pe.jsxs=Ye;Ve.exports=pe;var e=Ve.exports,Se={},Re=lt;Se.createRoot=Re.createRoot,Se.hydrateRoot=Re.hydrateRoot;const Qe=c.createContext(),z=()=>c.useContext(Qe),It=({children:t})=>{const[p,n]=c.useState(()=>{try{const h=localStorage.getItem("user");return h?JSON.parse(h):null}catch(h){return console.error("Error parsing user data:",h),localStorage.removeItem("user"),null}}),[m,r]=c.useState(!0),[o,a]=c.useState(!1);c.useEffect(()=>{const h=()=>{try{const d=localStorage.getItem("token"),s=localStorage.getItem("user");if(d&&s){const b=JSON.parse(s);b.plan==="ultra"&&b.role!=="admin"&&(b.role="admin",b.active=!0,localStorage.setItem("user",JSON.stringify(b))),b.plan==="ultra"&&!b.active&&(b.active=!0,localStorage.setItem("user",JSON.stringify(b))),n(b)}else n(null)}catch(d){console.error("Error initializing auth:",d),n(null),localStorage.removeItem("user"),localStorage.removeItem("token")}finally{r(!1),a(!0)}};h();const g=d=>{(d.key==="user"||d.key==="token")&&setTimeout(()=>{h()},50)},l=()=>{setTimeout(()=>{h()},100)};return window.addEventListener("storage",g),window.addEventListener("localStorageUpdated",l),()=>{window.removeEventListener("storage",g),window.removeEventListener("localStorageUpdated",l)}},[]);const x=(h,g)=>{try{localStorage.setItem("token",h),localStorage.setItem("user",JSON.stringify(g)),n(g)}catch(l){throw console.error("Error during login:",l),l}},u=async h=>{try{const g=localStorage.getItem("token"),l=window.location.hostname==="localhost"?"http://localhost:5001/api":"/api";localStorage.setItem("user",JSON.stringify(h)),n(h);try{const d=await fetch(`${l}/users/${h.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify(h)});if(!d.ok)throw new Error("Backend not available");const s=await d.json();return s.token&&localStorage.setItem("token",s.token),s.user&&(localStorage.setItem("user",JSON.stringify(s.user)),n(s.user)),s}catch(d){if(console.warn("Backend not available, using client-side update:",d),!g){const s=btoa(JSON.stringify({id:h.id,email:h.email,role:h.role,plan:h.plan}));localStorage.setItem("token",s)}return{user:h,token:g||btoa(JSON.stringify(h))}}}catch(g){throw console.error("Failed to update user:",g),g}},f=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),n(null)};return e.jsx(Qe.Provider,{value:{user:p,login:x,updateUser:u,logout:f,loading:m,isInitialized:o},children:t})};function Et(){const t=Q(),[p,n]=c.useState(!1),[m,r]=c.useState(0),o=[{title:"1. Sign Up & Choose Plan",desc:"Create your account and select between Basic (KSH 900) or Ultra (KSH 1,600) package",image:"ðŸ“",details:"First user becomes Admin automatically. Choose Ultra for full features including Recipe Builder and User Management."},{title:"2. Add Raw Materials",desc:"Stock your inventory with raw ingredients like fish, oil, breadcrumbs, salt, etc.",image:"ðŸ“¦",details:'Enter product name, cost, quantity, and unit. Mark items as "expense-only" to hide from cashiers.'},{title:"3. Create Recipes (Ultra Only)",desc:"Build composite products using the Recipe/BOM Builder",image:"ðŸ½ï¸",details:"Example: Fish Fingers = 0.02kg Nile Perch + 0.01L Oil + 0.004kg Breadcrumbs. System auto-calculates COGS and profit margin."},{title:"4. Add Cashiers (Ultra Only)",desc:"Invite team members and set their permissions",image:"ðŸ‘¥",details:"Enter name and email. Set permissions: View Sales, View Inventory, View Expenses, Manage Products. Default password: changeme123"},{title:"5. Make Sales",desc:"Cashiers use the POS to sell products",image:"ðŸ’°",details:"Search products, add to cart, select payment method (Cash/M-Pesa/Card), complete sale. Stock automatically deducted!"},{title:"6. Automatic Stock Deduction",desc:"When selling composite products, ingredients are auto-deducted",image:"âš¡",details:"Sell 1 Fish Finger â†’ System deducts 0.02kg fish, 0.01L oil, 0.004kg breadcrumbs. COGS calculated automatically!"},{title:"7. Track Analytics",desc:"Monitor sales, profit, expenses in real-time",image:"ðŸ“Š",details:"View daily/weekly sales, gross profit, net profit, COGS breakdown. Admin sees full analytics, cashiers see limited data."},{title:"8. Manage Expenses",desc:"Track manual expenses and automatic ingredient costs",image:"ðŸ’¸",details:"Add manual expenses (rent, utilities, salaries). System auto-creates expenses when expense-only items are used in recipes."}],a=[{icon:V,title:"Smart Inventory",desc:"Track raw materials & composite products with automatic stock deduction"},{icon:Be,title:"Recipe Builder",desc:"Create bundled products with BOM and auto-calculate COGS"},{icon:ee,title:"Real-time Analytics",desc:"Monitor sales, profit margins, and expenses in real-time"},{icon:de,title:"User Management",desc:"Add cashiers with custom permissions and role-based access"},{icon:He,title:"Secure & Reliable",desc:"JWT authentication with role-based security"},{icon:je,title:"Advanced Reports",desc:"Daily, weekly summaries with profit/loss tracking"}],x=[{name:"Basic",price:900,icon:Ke,popular:!1,features:["Cashier Dashboard","Basic Inventory","Sales Tracking","Daily/Weekly Reports","Single User","Email Support"]},{name:"Ultra",price:1600,icon:ze,popular:!0,features:["Admin + Cashier Dashboard","Full Inventory Management","Recipe/BOM Builder","Auto Stock Deduction","COGS Calculation","User Management","Permission Controls","Expense Tracking","Unlimited Users","Priority Support"]}];return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-blue-600 via-purple-600 to-pink-600",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-10"}),e.jsx("nav",{className:"relative z-10 px-6 py-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-white rounded-xl flex items-center justify-center",children:e.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"P"})}),e.jsx("span",{className:"text-2xl font-bold text-white",children:"POSify"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>t("/login"),className:"text-white hover:text-blue-100 font-medium",children:"Login"}),e.jsx("button",{onClick:()=>t("/signup"),className:"bg-white text-blue-600 px-6 py-2 rounded-lg font-semibold hover:shadow-lg transition-all",children:"Get Started"})]})]})}),e.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-6 py-20 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm px-4 py-2 rounded-full text-white text-sm font-medium mb-6",children:[e.jsx(ct,{className:"w-4 h-4 fill-yellow-300 text-yellow-300"}),"Trusted by 500+ businesses"]}),e.jsxs("h1",{className:"text-5xl md:text-7xl font-bold text-white mb-6 leading-tight",children:["Modern POS System",e.jsx("br",{}),e.jsx("span",{className:"text-blue-200",children:"Built for Growth"})]}),e.jsx("p",{className:"text-xl text-blue-100 mb-8 max-w-2xl mx-auto",children:"Complete inventory management with recipe builder, automatic stock deduction, and real-time analytics. Everything you need to run your business efficiently."}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsxs("button",{onClick:()=>t("/signup"),className:"bg-white text-blue-600 px-8 py-4 rounded-xl font-bold text-lg hover:shadow-2xl transform hover:scale-105 transition-all flex items-center gap-2",children:["Start Free Trial",e.jsx(ne,{className:"w-5 h-5"})]}),e.jsxs("button",{onClick:()=>n(!0),className:"border-2 border-white text-white px-8 py-4 rounded-xl font-bold text-lg hover:bg-white/10 transition-all flex items-center gap-2",children:[e.jsx(ot,{className:"w-5 h-5"}),"Watch Demo"]})]}),e.jsx("p",{className:"text-blue-200 text-sm mt-4",children:"No credit card required â€¢ 14-day free trial"})]}),e.jsx("div",{className:"relative z-10 max-w-6xl mx-auto px-6 pb-20",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl p-2 transform hover:scale-105 transition-all duration-500",children:e.jsx("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-8 aspect-video flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(je,{className:"w-24 h-24 text-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Dashboard Preview"})]})})})})]}),e.jsx("div",{className:"py-20 px-6 bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-4 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Everything You Need"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Powerful features to streamline your business operations"})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:a.map((u,f)=>{const h=u.icon;return e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-sm hover:shadow-xl transition-all transform hover:-translate-y-2",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl flex items-center justify-center mb-4",children:e.jsx(h,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:u.title}),e.jsx("p",{className:"text-gray-600",children:u.desc})]},f)})})]})}),e.jsx("div",{className:"py-20 px-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Simple, Transparent Pricing"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Choose the plan that fits your business"})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-8 max-w-5xl mx-auto",children:x.map((u,f)=>{const h=u.icon;return e.jsxs("div",{className:`relative bg-white rounded-2xl p-8 shadow-lg hover:shadow-2xl transition-all transform hover:scale-105 ${u.popular?"ring-4 ring-blue-600":""}`,children:[u.popular&&e.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2",children:e.jsx("span",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-4 py-1 rounded-full text-sm font-bold shadow-lg",children:"Most Popular"})}),e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${u.popular?"bg-gradient-to-br from-blue-600 to-purple-600":"bg-gradient-to-br from-green-600 to-teal-600"}`,children:e.jsx(h,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold",children:u.name}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Package"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("span",{className:"text-5xl font-bold",children:["KSH ",u.price]}),e.jsx("span",{className:"text-gray-600",children:"/month"})]}),e.jsx("ul",{className:"space-y-3 mb-8",children:u.features.map((g,l)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-gray-700",children:g})]},l))}),e.jsx("button",{onClick:()=>t("/signup"),className:`w-full py-4 rounded-xl font-bold text-lg transition-all ${u.popular?"bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:shadow-xl transform hover:scale-105":"bg-gray-100 text-gray-900 hover:bg-gray-200"}`,children:"Get Started"})]},f)})})]})}),e.jsx("div",{className:"py-20 px-6 bg-gradient-to-br from-blue-600 to-purple-600",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"grid md:grid-cols-4 gap-8 text-center text-white",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-5xl font-bold mb-2",children:"500+"}),e.jsx("div",{className:"text-blue-200",children:"Active Businesses"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-5xl font-bold mb-2",children:"50K+"}),e.jsx("div",{className:"text-blue-200",children:"Transactions/Day"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-5xl font-bold mb-2",children:"99.9%"}),e.jsx("div",{className:"text-blue-200",children:"Uptime"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-5xl font-bold mb-2",children:"24/7"}),e.jsx("div",{className:"text-blue-200",children:"Support"})]})]})})}),e.jsx("div",{className:"py-20 px-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[e.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-6",children:"Ready to Transform Your Business?"}),e.jsx("p",{className:"text-xl text-gray-600 mb-8",children:"Join hundreds of businesses already using POSify to streamline their operations"}),e.jsxs("button",{onClick:()=>t("/signup"),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-12 py-4 rounded-xl font-bold text-lg hover:shadow-2xl transform hover:scale-105 transition-all inline-flex items-center gap-2",children:["Start Your Free Trial",e.jsx(ne,{className:"w-5 h-5"})]}),e.jsx("p",{className:"text-gray-500 text-sm mt-4",children:"No credit card required â€¢ Cancel anytime"})]})}),e.jsx("footer",{className:"bg-gray-900 text-gray-400 py-12 px-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-600 to-purple-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-bold text-white",children:"P"})}),e.jsx("span",{className:"text-xl font-bold text-white",children:"POSify"})]}),e.jsx("p",{className:"mb-4",children:"Modern POS System for Modern Businesses"}),e.jsx("p",{className:"text-sm",children:"Â© 2024 POSify. All rights reserved."})]})}),p&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"How POSify Works"}),e.jsx("button",{onClick:()=>{n(!1),r(0)},className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(Ce,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-600",children:["Step ",m+1," of ",o.length]}),e.jsxs("span",{className:"text-sm font-medium text-blue-600",children:[Math.round((m+1)/o.length*100),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${(m+1)/o.length*100}%`}})})]}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:o[m].image}),e.jsx("h3",{className:"text-3xl font-bold mb-3",children:o[m].title}),e.jsx("p",{className:"text-xl text-gray-600 mb-4",children:o[m].desc}),e.jsx("div",{className:"bg-blue-50 rounded-xl p-6 text-left",children:e.jsx("p",{className:"text-gray-700",children:o[m].details})})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("button",{onClick:()=>r(Math.max(0,m-1)),disabled:m===0,className:"btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),m<o.length-1?e.jsxs("button",{onClick:()=>r(m+1),className:"btn-primary flex items-center gap-2",children:["Next Step",e.jsx(ne,{className:"w-4 h-4"})]}):e.jsxs("button",{onClick:()=>{n(!1),r(0),t("/signup")},className:"btn-primary bg-gradient-to-r from-blue-600 to-purple-600 flex items-center gap-2",children:["Get Started Now",e.jsx(ne,{className:"w-4 h-4"})]})]}),e.jsx("div",{className:"flex items-center justify-center gap-2 mt-8",children:o.map((u,f)=>e.jsx("button",{onClick:()=>r(f),className:`w-2 h-2 rounded-full transition-all ${f===m?"w-8 bg-blue-600":"bg-gray-300 hover:bg-gray-400"}`},f))})]})]})})]})}const Dt="/api",Ot=()=>localStorage.getItem("token"),O=async(t,p={})=>{const n=Ot(),m={...p,headers:{"Content-Type":"application/json",...n&&{Authorization:`Bearer ${n}`},...p.headers}};try{const r=await fetch(`${Dt}${t}`,m);if(t.includes("/auth/")){if(!r.ok){const a=await r.json().catch(()=>({error:"Authentication failed"}));throw new Error(a.error||"Authentication failed")}return await r.json()}return r.ok?await r.json():(console.warn(`API request failed: ${t} - ${r.status}`),Fe(t))}catch(r){if(t.includes("/auth/"))throw r;return console.warn(`API request error: ${t}`,r),Fe(t)}},Fe=t=>t.includes("/products")?[]:t.includes("/sales")?[]:t.includes("/expenses")?[]:t.includes("/users")?[]:t.includes("/reminders")?[]:t.includes("/stats")?{totalSales:0,totalExpenses:0,profit:0,grossProfit:0,netProfit:0,totalCOGS:0,dailySales:0,weeklySales:0,productCount:0}:t.includes("/settings")?{lockTimeout:3e5,currency:"KSH",logo:"",companyName:"",address:""}:t.includes("/service-fees")?[]:t.includes("/discounts")?[]:t.includes("/credit-requests")?[]:t.includes("/time-entries")?[]:t.includes("/categories")?[]:t.includes("/batches")?[]:t.includes("/production")?[]:t.includes("/price-history")?[]:{},be={login:t=>O("/auth/login",{method:"POST",body:JSON.stringify(t)}),signup:t=>O("/auth/signup",{method:"POST",body:JSON.stringify(t)})},B={getAll:()=>O("/products"),create:t=>O("/products",{method:"POST",body:JSON.stringify(t)}),update:(t,p)=>O(`/products/${t}`,{method:"PUT",body:JSON.stringify(p)}),delete:t=>O(`/products/${t}`,{method:"DELETE"})},me={getAll:()=>O("/sales"),create:t=>O("/sales",{method:"POST",body:JSON.stringify(t)})},$e={getAll:()=>O("/expenses"),create:t=>O("/expenses",{method:"POST",body:JSON.stringify(t)})},Ze={get:()=>O("/stats")},ie={getAll:()=>O("/users"),create:t=>O("/users",{method:"POST",body:JSON.stringify(t)}),update:(t,p)=>O(`/users/${t}`,{method:"PUT",body:JSON.stringify(p)}),delete:t=>O(`/users/${t}`,{method:"DELETE"})},ce={getAll:()=>O("/discounts"),create:t=>O("/discounts",{method:"POST",body:JSON.stringify(t)}),update:(t,p)=>O(`/discounts/${t}`,{method:"PUT",body:JSON.stringify(p)}),delete:t=>O(`/discounts/${t}`,{method:"DELETE"})},fe={getAll:()=>O("/credit-requests"),create:t=>O("/credit-requests",{method:"POST",body:JSON.stringify(t)}),approve:t=>O(`/credit-requests/${t}/approve`,{method:"POST"}),reject:t=>O(`/credit-requests/${t}/reject`,{method:"POST"})},ke={get:()=>O("/settings"),update:t=>O("/settings",{method:"POST",body:JSON.stringify(t)})};function qe(){const[t,p]=c.useState(!1),[n,m]=c.useState({email:"",password:"",name:"",newPassword:"",confirmPassword:""}),[r,o]=c.useState(""),[a,x]=c.useState(!1),[u,f]=c.useState(!1),h=Q(),{login:g}=z(),l=async d=>{d.preventDefault(),o(""),x(!0);try{if(u){if(n.newPassword!==n.confirmPassword){o("Passwords do not match"),x(!1);return}if(n.newPassword.length<6){o("Password must be at least 6 characters"),x(!1);return}const i=await be.login({email:n.email,newPassword:n.newPassword});i.token&&i.user&&(g(i.token,i.user),window.location.href="/cashier");return}let s;try{s=t?await be.login({email:n.email,password:n.password}):await be.signup(n)}catch{if(console.warn("Backend not available, using client-side auth"),t){const v=localStorage.getItem("user");if(v){const w=JSON.parse(v);if(w.email===n.email)s={token:btoa(JSON.stringify({id:w.id,email:w.email,role:w.role})),user:w};else throw new Error("Invalid credentials")}else throw new Error("No account found. Please sign up first.")}else{const v={id:Date.now(),email:n.email,password:n.password,name:n.name||n.email.split("@")[0],role:"admin",plan:null,price:null,active:!1,createdAt:new Date().toISOString()};s={token:btoa(JSON.stringify({id:v.id,email:v.email,role:v.role})),user:v}}}if(s.needsPasswordSetup){f(!0),m({...n,email:s.email}),o(""),x(!1);return}if(!s||!s.user)throw console.error("Invalid response:",s),new Error("Authentication failed. Please try again.");const b=s.token||btoa(JSON.stringify({id:s.user.id,email:s.user.email,role:s.user.role}));if(g(b,s.user),s.user.role==="cashier"&&s.user.addedByAdmin){window.location.href="/cashier";return}!s.user.active||!s.user.plan?h("/subscription"):s.user.role==="admin"?h("/admin"):s.user.role==="cashier"?h("/cashier"):h("/dashboard")}catch(s){o(s.message||"Authentication failed. Please try again.")}finally{x(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 flex items-center justify-center p-4 md:p-6",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-5"}),e.jsxs("div",{className:"card w-full max-w-md shadow-2xl backdrop-blur-sm bg-white/95 border-0 animate-fade-in relative z-10",children:[e.jsxs("div",{className:"text-center mb-6 md:mb-8",children:[e.jsx("div",{className:"w-14 h-14 md:w-16 md:h-16 bg-gradient-to-br from-blue-600 to-purple-600 rounded-2xl mx-auto mb-3 md:mb-4 flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-xl md:text-2xl font-bold text-white",children:"POS"})}),e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-2 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:t?"Welcome Back":"Get Started"}),e.jsx("p",{className:"text-gray-600 text-xs md:text-sm",children:t?"Login to your account":"Create your account to continue"})]}),e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[u?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-600 text-center mb-4",children:"Welcome! Please set your password to continue."}),e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"password",placeholder:"New Password",className:"input pl-10",value:n.newPassword,onChange:d=>m({...n,newPassword:d.target.value}),required:!0})]}),e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"password",placeholder:"Confirm Password",className:"input pl-10",value:n.confirmPassword,onChange:d=>m({...n,confirmPassword:d.target.value}),required:!0})]})]}):e.jsxs(e.Fragment,{children:[!t&&e.jsxs("div",{className:"relative",children:[e.jsx(he,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Full Name",className:"input pl-10",value:n.name,onChange:d=>m({...n,name:d.target.value}),required:!0})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ye,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"email",placeholder:"Email",className:"input pl-10",value:n.email,onChange:d=>m({...n,email:d.target.value}),required:!0})]}),e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"password",placeholder:"Password",className:"input pl-10",value:n.password,onChange:d=>m({...n,password:d.target.value}),required:!0})]})]}),r&&e.jsx("div",{className:"text-red-600 text-sm text-center",children:r}),e.jsx("button",{type:"submit",disabled:a,className:"btn-primary w-full text-base md:text-lg py-2.5 md:py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:a?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):u?"Set Password":t?"Login":"Sign Up"})]}),!u&&e.jsx("div",{className:"text-center mt-6",children:e.jsx("button",{onClick:()=>p(!t),className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-sm font-semibold transition-all",children:t?"Don't have an account? Sign up":"Already have an account? Login"})})]})]})}function Lt(){const[t,p]=c.useState("ultra"),n=Q(),{user:m,updateUser:r}=z(),o=[{id:"basic",name:"Basic Package",price:900,icon:Ke,color:"from-green-500 to-teal-600",features:["Cashier Dashboard Only","Basic Inventory Management","Sales Tracking","Daily/Weekly Sales Summaries","Basic Profit/Loss View","Limited Email Notifications","Record Products Sold","Single User Access"]},{id:"ultra",name:"Ultra Package",price:1600,icon:ze,color:"from-blue-600 to-purple-600",popular:!0,features:["Admin Dashboard + Cashier POS","Full Inventory Management","Recipe/BOM Builder","Composite Products Support","Automatic Stock Deduction","COGS Calculation","User Management","Permission Controls","Expense Tracking","Advanced Analytics","Unlimited Users"]}],a=async()=>{try{const x=o.find(l=>l.id===t),u=t==="ultra"?"admin":"cashier",f={...m,role:u,plan:t,price:x.price,active:!0};localStorage.setItem("user",JSON.stringify(f));const h=btoa(JSON.stringify({id:f.id,email:f.email,role:f.role,plan:f.plan,active:!0}));localStorage.setItem("token",h),window.dispatchEvent(new Event("storage")),window.dispatchEvent(new Event("localStorageUpdated")),r(f).catch(l=>{console.warn("Auth context update failed, but localStorage updated:",l)}),await new Promise(l=>setTimeout(l,1e3));const g=u==="admin"?"/admin":"/cashier";window.location.hostname!=="localhost"&&window.location.hostname!=="127.0.0.1"?window.location.href=g:n(g,{replace:!0})}catch(x){console.error("Subscription error:",x),alert("Failed to update subscription. Please try again.")}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 py-6 md:py-12 px-4 md:px-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8 md:mb-12 animate-fade-in",children:[e.jsx("h1",{className:"text-3xl md:text-5xl font-bold mb-3 md:mb-4 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Choose Your Plan"}),e.jsx("p",{className:"text-gray-600 text-base md:text-lg",children:"Select the perfect plan for your business needs"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8 mb-6 md:mb-8",children:o.map(x=>{const u=x.icon;return e.jsxs("div",{onClick:()=>p(x.id),className:`card cursor-pointer transition-all transform hover:scale-105 relative ${t===x.id?"ring-4 ring-blue-600 shadow-2xl bg-gradient-to-br from-blue-50 to-purple-50":"hover:shadow-xl"}`,children:[x.popular&&e.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2",children:e.jsx("span",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-4 py-1 rounded-full text-sm font-semibold shadow-lg",children:"Most Popular"})}),e.jsxs("div",{className:"flex items-center gap-3 mb-3 md:mb-4",children:[e.jsx("div",{className:`w-10 h-10 md:w-12 md:h-12 rounded-xl bg-gradient-to-br ${x.color} flex items-center justify-center`,children:e.jsx(u,{className:"w-5 h-5 md:w-6 md:h-6 text-white"})}),e.jsx("h3",{className:"text-xl md:text-2xl font-bold",children:x.name})]}),e.jsxs("div",{className:"mb-4 md:mb-6",children:[e.jsxs("span",{className:"text-3xl md:text-4xl font-bold",children:["KSH ",x.price]}),e.jsx("span",{className:"text-gray-600 text-sm md:text-base",children:"/month"})]}),e.jsx("ul",{className:"space-y-2 md:space-y-3",children:x.features.map((f,h)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Y,{className:"w-4 h-4 md:w-5 md:h-5 text-green-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-xs md:text-sm",children:f})]},h))})]},x.id)})}),e.jsxs("div",{className:"text-center animate-fade-in",children:[e.jsx("button",{onClick:a,className:"btn-primary w-full md:w-auto px-8 md:px-12 py-3 md:py-4 text-base md:text-lg bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all",children:"Continue to Dashboard"}),e.jsx("p",{className:"text-xs md:text-sm text-gray-500 mt-3 md:mt-4",children:"Start your journey today â€¢ Cancel anytime"})]})]})})}function Ut(){var f,h,g,l,d,s,b;const[t,p]=c.useState({stats:{totalSales:0,totalExpenses:0,profit:0,grossProfit:0,netProfit:0,totalCOGS:0,dailySales:0,weeklySales:0,productCount:0},recentSales:[]}),[n,m]=c.useState(!0),[r,o]=c.useState(null);c.useEffect(()=>{a()},[]);const a=async()=>{try{o(null);const[i,v]=await Promise.all([Ze.get(),me.getAll()]),w={totalSales:(i==null?void 0:i.totalSales)||0,totalExpenses:(i==null?void 0:i.totalExpenses)||0,profit:(i==null?void 0:i.profit)||0,grossProfit:(i==null?void 0:i.grossProfit)||0,netProfit:(i==null?void 0:i.netProfit)||0,totalCOGS:(i==null?void 0:i.totalCOGS)||0,dailySales:(i==null?void 0:i.dailySales)||0,weeklySales:(i==null?void 0:i.weeklySales)||0,productCount:(i==null?void 0:i.productCount)||0},k=Array.isArray(v)?v:[];p({stats:w,recentSales:k.slice(-10).reverse()})}catch(i){console.error("Failed to load data:",i),o(i.message),p({stats:{totalSales:0,totalExpenses:0,profit:0,grossProfit:0,netProfit:0,totalCOGS:0,dailySales:0,weeklySales:0,productCount:0},recentSales:[]})}finally{m(!1)}};if(n)return e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(r&&t.stats.totalSales===0&&t.recentSales.length===0)return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[e.jsx(Ne,{className:"w-12 h-12 text-red-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Unable to Load Dashboard"}),e.jsx("p",{className:"text-red-600 mb-4",children:r}),e.jsx("button",{onClick:a,className:"btn-primary",children:"Retry"})]})});const x=[{label:"Total Sales",value:`KSH ${((f=t.stats.totalSales)==null?void 0:f.toLocaleString())||0}`,icon:ae,color:"from-green-500 to-emerald-600",change:"+12.5%"},{label:"Gross Profit",value:`KSH ${((h=t.stats.grossProfit)==null?void 0:h.toLocaleString())||0}`,icon:ee,color:"from-blue-500 to-indigo-600",change:"+8.2%"},{label:"Total COGS",value:`KSH ${((g=t.stats.totalCOGS)==null?void 0:g.toLocaleString())||0}`,icon:V,color:"from-orange-500 to-red-600",change:"+5.1%"},{label:"Net Profit",value:`KSH ${((l=t.stats.netProfit)==null?void 0:l.toLocaleString())||0}`,icon:ee,color:"from-purple-500 to-pink-600",change:"+15.3%"}],u=[{label:"Daily Sales",value:`KSH ${((d=t.stats.dailySales)==null?void 0:d.toLocaleString())||0}`,icon:Je,color:"bg-blue-50 text-blue-600"},{label:"Weekly Sales",value:`KSH ${((s=t.stats.weeklySales)==null?void 0:s.toLocaleString())||0}`,icon:ee,color:"bg-green-50 text-green-600"},{label:"Total Expenses",value:`KSH ${((b=t.stats.totalExpenses)==null?void 0:b.toLocaleString())||0}`,icon:_e,color:"bg-red-50 text-red-600"},{label:"Products",value:t.stats.productCount||0,icon:V,color:"bg-purple-50 text-purple-600"}];return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:(x||[]).map((i,v)=>{const w=i==null?void 0:i.icon;return w?e.jsxs("div",{className:`card bg-gradient-to-br ${i.color} text-white border-0 shadow-lg hover:shadow-xl transition-all transform hover:scale-105`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:e.jsx(w,{className:"w-6 h-6"})}),e.jsx("span",{className:"text-sm font-semibold bg-white/20 px-2 py-1 rounded-full",children:i.change})]}),e.jsx("p",{className:"text-sm text-white/80 mb-1",children:i.label}),e.jsx("p",{className:"text-2xl font-bold",children:i.value})]},v):null})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:(u||[]).map((i,v)=>{const w=i==null?void 0:i.icon;return w?e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl ${i.color} flex items-center justify-center`,children:e.jsx(w,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:i.label}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:i.value})]})]})},v):null})}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Recent Sales"}),e.jsx("button",{className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View All"})]}),!t.recentSales||t.recentSales.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ne,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No sales yet"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Date & Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Items"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Payment"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"COGS"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Profit"})]})}),e.jsx("tbody",{children:(t.recentSales||[]).map(i=>{var v,w,k;return i?e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:i.createdAt?new Date(i.createdAt).toLocaleString():"N/A"}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[Array.isArray(i.items)?i.items.length:0," items"]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"badge badge-success",children:i.paymentMethod||"N/A"})}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-green-600",children:["KSH ",((v=i.total)==null?void 0:v.toLocaleString())||0]}),e.jsxs("td",{className:"px-4 py-3 text-sm text-orange-600",children:["KSH ",((w=i.cogs)==null?void 0:w.toLocaleString())||0]}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-blue-600",children:["KSH ",((k=i.profit)==null?void 0:k.toLocaleString())||0]})]},i.id||Math.random()):null})})]})})]})]})}function Tt(){const[t,p]=c.useState([]),[n,m]=c.useState("all"),[r,o]=c.useState(""),[a,x]=c.useState(!1),[u,f]=c.useState(!1),[h,g]=c.useState(null),[l,d]=c.useState({name:"",price:"",cost:"",quantity:"",unit:"pcs",category:"raw",expenseOnly:!1}),[s,b]=c.useState({name:"",price:"",cost:"",quantity:"",unit:"pcs",category:"raw",expenseOnly:!1});c.useEffect(()=>{i()},[]);const i=async()=>{try{const j=await B.getAll();p(Array.isArray(j)?j:[])}catch(j){console.error("Failed to load products:",j),p([])}},v=async j=>{j.preventDefault(),await B.create({...l,price:parseFloat(l.price),cost:parseFloat(l.cost),quantity:parseFloat(l.quantity)}),d({name:"",price:"",cost:"",quantity:"",unit:"pcs",category:"raw",expenseOnly:!1}),x(!1),i()},w=async j=>{confirm("Are you sure you want to delete this product?")&&(await B.delete(j),i())},k=(t||[]).filter(j=>{var y;if(!j)return!1;const T=(y=j.name)==null?void 0:y.toLowerCase().includes(r.toLowerCase()),$=n==="all"||n==="raw"&&!j.recipe||n==="composite"&&j.recipe||n==="expense"&&j.expenseOnly||n==="low-stock"&&j.quantity<10;return T&&$}),I=(t||[]).filter(j=>j&&!j.recipe&&!j.expenseOnly),q=(t||[]).filter(j=>j&&j.recipe),M=(t||[]).filter(j=>j&&j.expenseOnly),Z=j=>{if(!j||!j.recipe)return 0;let T=1/0;return(j.recipe||[]).forEach($=>{if(!$)return;const y=(t||[]).find(S=>S&&S.id===$.productId);if(y&&y.quantity>0&&$.quantity>0){const S=Math.floor(y.quantity/$.quantity);T=Math.min(T,S)}}),T===1/0?0:T},J=j=>{if(!j)return 0;if(!j.recipe)return j.cost||0;let T=0;return(j.recipe||[]).forEach($=>{if(!$)return;const y=(t||[]).find(S=>S&&S.id===$.productId);if(y&&y.quantity>0){const S=(y.cost||0)/y.quantity;T+=S*($.quantity||0)}}),T};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Pe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search products...",className:"input pl-10 w-80",value:r,onChange:j=>o(j.target.value)})]}),e.jsxs("select",{value:n,onChange:j=>m(j.target.value),className:"input w-40",children:[e.jsx("option",{value:"all",children:"All Products"}),e.jsx("option",{value:"raw",children:"Raw Materials"}),e.jsx("option",{value:"composite",children:"Composite"}),e.jsx("option",{value:"expense",children:"Expense Only"}),e.jsx("option",{value:"low-stock",children:"Low Stock"})]})]}),e.jsxs("button",{onClick:()=>x(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"}),"Add Product"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-700 mb-2",children:"Raw Materials"}),e.jsx("p",{className:"text-3xl font-bold text-blue-900",children:I.length})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:[e.jsx("h4",{className:"text-sm font-medium text-purple-700 mb-2",children:"Composite Products"}),e.jsx("p",{className:"text-3xl font-bold text-purple-900",children:q.length})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:[e.jsx("h4",{className:"text-sm font-medium text-orange-700 mb-2",children:"Expense Items"}),e.jsx("p",{className:"text-3xl font-bold text-orange-900",children:M.length})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Product Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Price"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Cost/COGS"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Stock"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Max Units"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Margin"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:(k||[]).map(j=>{var C;if(!j)return null;const T=J(j),$=j.price?((j.price-T)/j.price*100).toFixed(1):0,y=Z(j),S=h===j.id;return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[j.recipe&&e.jsx("button",{onClick:()=>g(S?null:j.id),className:"p-1 hover:bg-gray-200 rounded",children:S?e.jsx(dt,{className:"w-4 h-4"}):e.jsx(xt,{className:"w-4 h-4"})}),e.jsx("span",{className:"font-medium",children:j.name}),j.quantity<10&&!j.recipe&&e.jsx(Ge,{className:"w-4 h-4 text-orange-500"})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`badge ${j.expenseOnly?"badge-warning":j.recipe?"badge-success":"bg-blue-100 text-blue-800"}`,children:j.expenseOnly?"Expense":j.recipe?"Composite":"Raw"})}),e.jsxs("td",{className:"px-4 py-3 font-semibold text-green-600",children:["KSH ",(C=j.price)==null?void 0:C.toLocaleString()]}),e.jsxs("td",{className:"px-4 py-3 text-orange-600",children:["KSH ",T.toLocaleString()]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:`font-medium ${j.quantity<10&&!j.recipe?"text-red-600":"text-gray-900"}`,children:[j.quantity," ",j.unit]})}),e.jsx("td",{className:"px-4 py-3",children:j.recipe?e.jsxs("span",{className:"font-semibold text-blue-600",children:[y," units"]}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:`font-semibold ${$>30?"text-green-600":$>15?"text-yellow-600":"text-red-600"}`,children:[$,"%"]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{b(j),f(!0)},className:"p-2 hover:bg-blue-50 rounded-lg text-blue-600 transition-colors",children:e.jsx(ue,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>w(j.id),className:"p-2 hover:bg-red-50 rounded-lg text-red-600 transition-colors",children:e.jsx(K,{className:"w-4 h-4"})})]})})]},j.id),S&&j.recipe&&e.jsx("tr",{className:"bg-blue-50",children:e.jsx("td",{colSpan:"8",className:"px-4 py-4",children:e.jsxs("div",{className:"ml-8",children:[e.jsx("h4",{className:"font-semibold text-sm text-gray-700 mb-3",children:"Recipe Breakdown:"}),e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-600",children:"Ingredient"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-600",children:"Quantity Needed"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-600",children:"Available"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-600",children:"Unit Cost"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-600",children:"Total Cost"})]})}),e.jsx("tbody",{children:(j.recipe||[]).map((P,L)=>{if(!P)return null;const A=(t||[]).find(E=>E&&E.id===P.productId);if(!A)return null;const R=(A.cost||0)/(A.quantity||1),_=R*(P.quantity||0);return e.jsxs("tr",{className:"border-t border-blue-100",children:[e.jsx("td",{className:"px-3 py-2",children:A.name||"Unknown"}),e.jsxs("td",{className:"px-3 py-2",children:[P.quantity||0," ",A.unit||"pcs"]}),e.jsxs("td",{className:"px-3 py-2",children:[A.quantity||0," ",A.unit||"pcs"]}),e.jsxs("td",{className:"px-3 py-2",children:["KSH ",R.toFixed(2)]}),e.jsxs("td",{className:"px-3 py-2 font-semibold",children:["KSH ",_.toFixed(2)]})]},L)})}),e.jsx("tfoot",{className:"bg-white font-semibold",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:"4",className:"px-3 py-2 text-right",children:"Total COGS per unit:"}),e.jsxs("td",{className:"px-3 py-2 text-orange-600",children:["KSH ",T.toFixed(2)]})]})})]})]})})})]})})})]})})}),a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Add New Product"}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Product Name",className:"input",value:l.name,onChange:j=>d({...l,name:j.target.value}),required:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("input",{type:"number",step:"0.01",placeholder:"Price",className:"input",value:l.price,onChange:j=>d({...l,price:j.target.value}),required:!0}),e.jsx("input",{type:"number",step:"0.01",placeholder:"Cost",className:"input",value:l.cost,onChange:j=>d({...l,cost:j.target.value}),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("input",{type:"number",step:"0.01",placeholder:"Quantity",className:"input",value:l.quantity,onChange:j=>d({...l,quantity:j.target.value}),required:!0}),e.jsxs("select",{className:"input",value:l.unit,onChange:j=>d({...l,unit:j.target.value}),children:[e.jsx("option",{value:"pcs",children:"Pieces"}),e.jsx("option",{value:"kg",children:"Kilograms"}),e.jsx("option",{value:"L",children:"Liters"}),e.jsx("option",{value:"g",children:"Grams"}),e.jsx("option",{value:"ml",children:"Milliliters"})]})]}),e.jsxs("select",{className:"input",value:l.category,onChange:j=>d({...l,category:j.target.value}),children:[e.jsx("option",{value:"raw",children:"Raw Material"}),e.jsx("option",{value:"finished",children:"Finished Product"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:l.expenseOnly,onChange:j=>d({...l,expenseOnly:j.target.checked})}),e.jsx("span",{className:"text-sm",children:"Expense Only (Hidden from cashier)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Add Product"}),e.jsx("button",{type:"button",onClick:()=>x(!1),className:"btn-secondary",children:"Cancel"})]})]})]})})]})}function Rt(){const[t,p]=c.useState([]),[n,m]=c.useState([]),[r,o]=c.useState(!1),[a,x]=c.useState({name:"",price:"",ingredients:[]});c.useEffect(()=>{u()},[]);const u=async()=>{const b=await B.getAll();p(b),m(b.filter(i=>!i.recipe))},f=()=>{x({...a,ingredients:[...a.ingredients,{productId:"",quantity:""}]})},h=(b,i,v)=>{const w=[...a.ingredients];w[b][i]=i==="quantity"?parseFloat(v):parseInt(v),x({...a,ingredients:w})},g=b=>{x({...a,ingredients:a.ingredients.filter((i,v)=>v!==b)})},l=()=>a.ingredients.reduce((b,i)=>{const v=n.find(w=>w.id===parseInt(i.productId));if(v&&i.quantity){const w=v.cost/v.quantity;return b+w*i.quantity}return b},0),d=async b=>{b.preventDefault();const i=l();await B.create({name:a.name,price:parseFloat(a.price),cost:i,quantity:0,unit:"pcs",category:"composite",recipe:a.ingredients.filter(v=>v.productId&&v.quantity),visibleToCashier:!0}),x({name:"",price:"",ingredients:[]}),o(!1),u()},s=t.filter(b=>b.recipe);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Recipe & BOM Builder"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create composite products with ingredient recipes"})]}),e.jsxs("button",{onClick:()=>o(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"}),"Create Recipe"]})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-blue-50 to-purple-50 border-blue-200",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"ðŸ’¡ How it works"}),e.jsx("p",{className:"text-sm text-blue-800",children:"Create composite products by defining recipes with raw ingredients. When a composite product is sold, the system automatically deducts the required quantities from raw materials and calculates COGS."}),e.jsxs("div",{className:"mt-3 p-3 bg-white rounded-lg text-sm",children:[e.jsx("strong",{children:"Example: Fish Fingers"}),e.jsxs("ul",{className:"mt-2 space-y-1 text-gray-700",children:[e.jsx("li",{children:"â€¢ 0.02 kg Nile Perch"}),e.jsx("li",{children:"â€¢ 0.01 L Cooking Oil"}),e.jsx("li",{children:"â€¢ 0.004 kg Breadcrumbs"}),e.jsx("li",{children:"â€¢ 0.002 kg Salt"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["Existing Recipes (",s.length,")"]}),s.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No recipes created yet"})}):e.jsx("div",{className:"space-y-4",children:s.map(b=>{const i=b.recipe.reduce((w,k)=>{const I=t.find(q=>q.id===k.productId);if(I){const q=I.cost/I.quantity;return w+q*k.quantity}return w},0),v=((b.price-i)/b.price*100).toFixed(1);return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-lg",children:b.name}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm",children:[e.jsxs("span",{className:"text-green-600 font-semibold",children:["Price: KSH ",b.price]}),e.jsxs("span",{className:"text-orange-600",children:["COGS: KSH ",i.toFixed(2)]}),e.jsxs("span",{className:`font-semibold ${v>30?"text-green-600":"text-yellow-600"}`,children:["Margin: ",v,"%"]})]})]}),e.jsx("button",{className:"text-red-600 hover:bg-red-50 p-2 rounded-lg",children:e.jsx(K,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-600 mb-2",children:"INGREDIENTS:"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:b.recipe.map((w,k)=>{const I=t.find(q=>q.id===w.productId);return I?e.jsxs("div",{className:"text-sm flex items-center justify-between bg-white px-3 py-2 rounded",children:[e.jsx("span",{children:I.name}),e.jsxs("span",{className:"font-semibold text-blue-600",children:[w.quantity," ",I.unit]})]},k):null})})]})]},b.id)})})]}),r&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Create New Recipe"}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",placeholder:"Product Name (e.g., Fish Fingers)",className:"input",value:a.name,onChange:b=>x({...a,name:b.target.value}),required:!0}),e.jsx("input",{type:"number",step:"0.01",placeholder:"Selling Price",className:"input",value:a.price,onChange:b=>x({...a,price:b.target.value}),required:!0})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-semibold",children:"Ingredients"}),e.jsx("button",{type:"button",onClick:f,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"+ Add Ingredient"})]}),e.jsx("div",{className:"space-y-3",children:a.ingredients.map((b,i)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{className:"input flex-1",value:b.productId,onChange:v=>h(i,"productId",v.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select ingredient..."}),n.map(v=>e.jsxs("option",{value:v.id,children:[v.name," (",v.quantity," ",v.unit," available)"]},v.id))]}),e.jsx("input",{type:"number",step:"0.001",placeholder:"Qty",className:"input w-32",value:b.quantity,onChange:v=>h(i,"quantity",v.target.value),required:!0}),e.jsx("button",{type:"button",onClick:()=>g(i),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:e.jsx(K,{className:"w-4 h-4"})})]},i))}),a.ingredients.length===0&&e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:'No ingredients added yet. Click "Add Ingredient" to start.'})]}),a.ingredients.length>0&&e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium",children:"Estimated COGS:"}),e.jsxs("span",{className:"text-lg font-bold text-orange-600",children:["KSH ",l().toFixed(2)]})]}),a.price&&e.jsxs("div",{className:"flex items-center justify-between text-sm mt-2",children:[e.jsx("span",{className:"font-medium",children:"Profit Margin:"}),e.jsxs("span",{className:"text-lg font-bold text-green-600",children:[((parseFloat(a.price)-l())/parseFloat(a.price)*100).toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs("button",{type:"submit",className:"btn-primary flex-1 flex items-center justify-center gap-2",children:[e.jsx(mt,{className:"w-4 h-4"}),"Create Recipe"]}),e.jsx("button",{type:"button",onClick:()=>{o(!1),x({name:"",price:"",ingredients:[]})},className:"btn-secondary",children:"Cancel"})]})]})]})})]})}function Ft(){const[t,p]=c.useState([]),[n,m]=c.useState("all");c.useEffect(()=>{r()},[]);const r=async()=>{const f=await me.getAll();p(f.reverse())},o=t.filter(f=>{if(n==="today")return new Date(f.createdAt).toDateString()===new Date().toDateString();if(n==="week"){const h=new Date;return h.setDate(h.getDate()-7),new Date(f.createdAt)>=h}return!0}),a=o.reduce((f,h)=>f+h.total,0),x=o.reduce((f,h)=>f+(h.cogs||0),0),u=a-x;return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("select",{value:n,onChange:f=>m(f.target.value),className:"input w-40",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"This Week"})]})}),e.jsxs("button",{className:"btn-secondary flex items-center gap-2",children:[e.jsx(ht,{className:"w-4 h-4"}),"Export"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card bg-gradient-to-br from-green-500 to-emerald-600 text-white",children:[e.jsx("p",{className:"text-sm text-green-100 mb-1",children:"Total Sales"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",a.toLocaleString()]})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-orange-500 to-red-600 text-white",children:[e.jsx("p",{className:"text-sm text-orange-100 mb-1",children:"Total COGS"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",x.toLocaleString()]})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-blue-500 to-indigo-600 text-white",children:[e.jsx("p",{className:"text-sm text-blue-100 mb-1",children:"Total Profit"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",u.toLocaleString()]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Sales History"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Date & Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Items"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Payment"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"COGS"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Profit"})]})}),e.jsx("tbody",{children:o.map(f=>{var h,g,l,d;return e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50",children:[e.jsxs("td",{className:"px-4 py-3 text-sm font-medium",children:["#",f.id]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(f.createdAt).toLocaleString()}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[((h=f.items)==null?void 0:h.length)||0," items"]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"badge badge-success",children:f.paymentMethod})}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-green-600",children:["KSH ",(g=f.total)==null?void 0:g.toLocaleString()]}),e.jsxs("td",{className:"px-4 py-3 text-sm text-orange-600",children:["KSH ",((l=f.cogs)==null?void 0:l.toLocaleString())||0]}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-blue-600",children:["KSH ",((d=f.profit)==null?void 0:d.toLocaleString())||0]})]},f.id)})})]})})]})]})}function $t(){const[t,p]=c.useState([]),[n,m]=c.useState(!1),[r,o]=c.useState({description:"",amount:"",category:"general"});c.useEffect(()=>{a()},[]);const a=async()=>{const g=await $e.getAll();p(g.reverse())},x=async g=>{g.preventDefault(),await $e.create({...r,amount:parseFloat(r.amount)}),o({description:"",amount:"",category:"general"}),m(!1),a()},u=t.reduce((g,l)=>g+l.amount,0),f=t.filter(g=>!g.automatic),h=t.filter(g=>g.automatic);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Expense Management"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Track manual and automatic ingredient-based expenses"})]}),e.jsxs("button",{onClick:()=>m(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"}),"Add Expense"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card bg-gradient-to-br from-red-500 to-pink-600 text-white",children:[e.jsx("p",{className:"text-sm text-red-100 mb-1",children:"Total Expenses"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",u.toLocaleString()]})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-blue-500 to-indigo-600 text-white",children:[e.jsx("p",{className:"text-sm text-blue-100 mb-1",children:"Manual Expenses"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",f.reduce((g,l)=>g+l.amount,0).toLocaleString()]})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-purple-500 to-violet-600 text-white",children:[e.jsx("p",{className:"text-sm text-purple-100 mb-1",children:"Auto Expenses"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",h.reduce((g,l)=>g+l.amount,0).toLocaleString()]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Expense History"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Amount"})]})}),e.jsx("tbody",{children:t.map(g=>{var l;return e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(g.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-sm",children:g.description}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"badge badge-warning",children:g.category})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`badge ${g.automatic?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"}`,children:g.automatic?"Automatic":"Manual"})}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-red-600",children:["KSH ",(l=g.amount)==null?void 0:l.toLocaleString()]})]},g.id)})})]})})]}),n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Add Manual Expense"}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Description",className:"input",value:r.description,onChange:g=>o({...r,description:g.target.value}),required:!0}),e.jsx("input",{type:"number",step:"0.01",placeholder:"Amount",className:"input",value:r.amount,onChange:g=>o({...r,amount:g.target.value}),required:!0}),e.jsxs("select",{className:"input",value:r.category,onChange:g=>o({...r,category:g.target.value}),children:[e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"utilities",children:"Utilities"}),e.jsx("option",{value:"rent",children:"Rent"}),e.jsx("option",{value:"salaries",children:"Salaries"}),e.jsx("option",{value:"supplies",children:"Supplies"}),e.jsx("option",{value:"other",children:"Other"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Add Expense"}),e.jsx("button",{type:"button",onClick:()=>m(!1),className:"btn-secondary",children:"Cancel"})]})]})]})})]})}function qt(){const[t,p]=c.useState([]),[n,m]=c.useState(!1),[r,o]=c.useState(null),[a,x]=c.useState({name:"",email:"",permissions:{viewSales:!0,viewInventory:!0,viewExpenses:!1,manageProducts:!1}});c.useEffect(()=>{u()},[]);const u=async()=>{const d=await ie.getAll();p(d)},f=async d=>{d.preventDefault();try{console.log("Creating cashier with data:",a);const s=await ie.create(a);console.log("Cashier created:",s),x({name:"",email:"",permissions:{viewSales:!0,viewInventory:!0,viewExpenses:!1,manageProducts:!1}}),m(!1),u(),alert("Cashier added successfully!")}catch(s){console.error("Error creating cashier:",s),alert("Failed to add cashier: "+(s.message||"Unknown error"))}},h=async(d,s)=>{await ie.update(d,{permissions:s}),u(),o(null)},g=async d=>{confirm("Are you sure you want to delete this user?")&&(await ie.delete(d),u())},l=t.filter(d=>d.role==="cashier");return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"User Management"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage cashiers and their permissions"})]}),e.jsxs("button",{onClick:()=>m(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"}),"Add Cashier"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:[e.jsx("p",{className:"text-sm text-blue-700 mb-1",children:"Total Users"}),e.jsx("p",{className:"text-3xl font-bold text-blue-900",children:t.length})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:[e.jsx("p",{className:"text-sm text-green-700 mb-1",children:"Cashiers"}),e.jsx("p",{className:"text-3xl font-bold text-green-900",children:l.length})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:[e.jsx("p",{className:"text-sm text-purple-700 mb-1",children:"Admins"}),e.jsx("p",{className:"text-3xl font-bold text-purple-900",children:t.filter(d=>d.role==="admin").length})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Users"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Role"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Plan"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Permissions"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:t.map(d=>e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:d.name}),e.jsx("td",{className:"px-4 py-3 text-sm",children:d.email}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`badge ${d.role==="admin"?"bg-purple-100 text-purple-800":"badge-success"}`,children:d.role})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"badge badge-warning",children:d.plan||"N/A"})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:d.role==="cashier"?e.jsx("button",{onClick:()=>o(d),className:"text-blue-600 hover:text-blue-700 text-xs font-medium",children:"Edit Permissions"}):e.jsx("span",{className:"text-gray-400 text-xs",children:"Full Access"})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:d.role==="cashier"&&e.jsx("button",{onClick:()=>g(d.id),className:"p-2 hover:bg-red-50 rounded-lg text-red-600",children:e.jsx(K,{className:"w-4 h-4"})})})]},d.id))})]})})]}),n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Add New Cashier"}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Full Name",className:"input",value:a.name,onChange:d=>x({...a,name:d.target.value}),required:!0}),e.jsx("input",{type:"email",placeholder:"Email",className:"input",value:a.email,onChange:d=>x({...a,email:d.target.value}),required:!0}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-semibold mb-3 text-sm",children:"Permissions"}),e.jsx("div",{className:"space-y-2",children:Object.entries(a.permissions).map(([d,s])=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s,onChange:b=>x({...a,permissions:{...a.permissions,[d]:b.target.checked}})}),e.jsx("span",{className:"text-sm capitalize",children:d.replace(/([A-Z])/g," $1").trim()})]},d))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Add Cashier"}),e.jsx("button",{type:"button",onClick:()=>m(!1),className:"btn-secondary",children:"Cancel"})]})]})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4",children:["Edit Permissions: ",r.name]}),e.jsx("div",{className:"space-y-3",children:Object.entries(r.permissions||{}).map(([d,s])=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s,onChange:b=>o({...r,permissions:{...r.permissions,[d]:b.target.checked}})}),e.jsx("span",{className:"text-sm capitalize",children:d.replace(/([A-Z])/g," $1").trim()})]},d))}),e.jsxs("div",{className:"flex gap-2 mt-6",children:[e.jsx("button",{onClick:()=>h(r.id,r.permissions),className:"btn-primary flex-1",children:"Save Changes"}),e.jsx("button",{onClick:()=>o(null),className:"btn-secondary",children:"Cancel"})]})]})})]})}function Mt(){const[t,p]=c.useState([]),[n,m]=c.useState("all");c.useEffect(()=>{r()},[]);const r=()=>{const u=JSON.parse(localStorage.getItem("clockRecords")||"[]");p(u.reverse())},o=n==="all"?t:t.filter(u=>u.date===new Date().toDateString()),a=o.filter(u=>u.date===new Date().toDateString()).reduce((u,f)=>u+f.duration,0)/60,x=u=>{const f=Math.floor(u/60),h=u%60;return`${f}h ${h}m`};return e.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Time Tracking"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Monitor cashier clock in/out records"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6",children:[e.jsx("div",{className:"card bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-xl flex items-center justify-center",children:e.jsx(Ae,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-700",children:"Total Hours Today"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-900",children:[a.toFixed(1),"h"]})]})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-green-600 rounded-xl flex items-center justify-center",children:e.jsx(he,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-700",children:"Active Cashiers"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:new Set(o.filter(u=>u.date===new Date().toDateString()).map(u=>u.userId)).size})]})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-600 rounded-xl flex items-center justify-center",children:e.jsx(xe,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-purple-700",children:"Total Records"}),e.jsx("p",{className:"text-2xl font-bold text-purple-900",children:t.length})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Clock Records"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>m("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${n==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"All Time"}),e.jsx("button",{onClick:()=>m("today"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${n==="today"?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Today"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Cashier"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Clock In"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Clock Out"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Duration"})]})}),e.jsx("tbody",{children:o.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-4 py-8 text-center text-gray-500",children:"No records found"})}):o.map((u,f)=>e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:u.userName}),e.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(u.clockIn).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(u.clockIn).toLocaleTimeString()}),e.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(u.clockOut).toLocaleTimeString()}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"badge badge-success",children:x(u.duration)})})]},f))})]})})]})]})}function Bt(){var v;const{user:t,updateUser:p}=z();Q();const[n,m]=c.useState(!1),[r,o]=c.useState((t==null?void 0:t.plan)||"ultra"),[a,x]=c.useState({}),[u,f]=c.useState(null),[h,g]=c.useState((t==null?void 0:t.profilePicture)||null);c.useEffect(()=>{l()},[]);const l=async()=>{try{const w=await ke.get();x(w),w.logo&&f(w.logo)}catch(w){console.error("Failed to load settings:",w)}},d=async w=>{const k=w.target.files[0];if(k){const I=new FileReader;I.onloadend=async()=>{const q=I.result;f(q);try{await ke.update({...a,logo:q}),x({...a,logo:q})}catch(M){console.error("Failed to save logo:",M)}},I.readAsDataURL(k)}},s=async w=>{const k=w.target.files[0];if(k){const I=new FileReader;I.onloadend=async()=>{const q=I.result;g(q);try{await p({...t,profilePicture:q})}catch(M){console.error("Failed to save profile picture:",M)}},I.readAsDataURL(k)}},b=[{id:"basic",name:"Basic Package",price:900,features:["Cashier Dashboard","Sales Tracking","Product Management","Basic Reports"]},{id:"ultra",name:"Ultra Package",price:1600,features:["Admin Dashboard","Recipe Builder","User Management","Advanced Analytics","Expense Tracking"]}],i=async()=>{const w=b.find(I=>I.id===r),k=r==="ultra"?"admin":"cashier";await p({...t,role:k,plan:r,price:w.price}),m(!1),setTimeout(()=>window.location.href=k==="admin"?"/admin":"/cashier",500)};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Settings"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage your account and preferences"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx(he,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Account Information"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[h?e.jsx("img",{src:h,alt:"Profile",className:"w-20 h-20 rounded-full object-cover"}):e.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center text-white text-2xl font-bold",children:(v=t==null?void 0:t.name)==null?void 0:v.charAt(0).toUpperCase()}),e.jsxs("label",{className:"absolute bottom-0 right-0 bg-blue-600 text-white p-1.5 rounded-full cursor-pointer hover:bg-blue-700 transition",children:[e.jsx(Te,{className:"w-3 h-3"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:s})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Name"}),e.jsx("p",{className:"font-medium",children:t==null?void 0:t.name})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Email"}),e.jsx("p",{className:"font-medium",children:t==null?void 0:t.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Role"}),e.jsx("p",{className:"font-medium capitalize",children:t==null?void 0:t.role})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx(te,{className:"w-5 h-5 text-purple-600"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Subscription"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Current Plan"}),e.jsxs("p",{className:"font-medium capitalize",children:[(t==null?void 0:t.plan)||"Ultra"," Package"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Price"}),e.jsxs("p",{className:"font-medium",children:["KSH ",(t==null?void 0:t.price)||1600,"/month"]})]}),e.jsx("button",{onClick:()=>m(!0),className:"btn-secondary text-sm",children:"Change Plan"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center",children:e.jsx(Ie,{className:"w-5 h-5 text-green-600"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Notifications"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Email Notifications"}),e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"toggle"})]}),e.jsxs("label",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Low Stock Alerts"}),e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"toggle"})]}),e.jsxs("label",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Daily Sales Summary"}),e.jsx("input",{type:"checkbox",className:"toggle"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-100 flex items-center justify-center",children:e.jsx(He,{className:"w-5 h-5 text-red-600"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Security"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{className:"btn-secondary text-sm w-full",children:"Change Password"}),e.jsx("button",{className:"btn-secondary text-sm w-full",children:"Enable 2FA"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx(ut,{className:"w-5 h-5 text-purple-600"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Screen Lock Logo"})]}),e.jsxs("div",{className:"space-y-3",children:[u&&e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:u,alt:"Logo Preview",className:"w-32 h-32 object-contain rounded-lg border-2 border-gray-200"})}),e.jsxs("label",{className:"btn-secondary text-sm w-full cursor-pointer flex items-center justify-center gap-2",children:[e.jsx(Te,{className:"w-4 h-4"}),"Upload Logo",e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:d})]}),e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"This logo will appear on the screen lock"})]})]})]}),n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-6",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-2xl font-bold mb-6",children:"Change Your Plan"}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:b.map(w=>e.jsxs("div",{onClick:()=>o(w.id),className:`card cursor-pointer transition-all ${r===w.id?"ring-4 ring-blue-600 bg-blue-50":"hover:shadow-lg"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-xl font-bold",children:w.name}),r===w.id&&e.jsx(Y,{className:"w-6 h-6 text-blue-600"})]}),e.jsxs("p",{className:"text-3xl font-bold mb-4",children:["KSH ",w.price,e.jsx("span",{className:"text-sm text-gray-600",children:"/month"})]}),e.jsx("ul",{className:"space-y-2",children:w.features.map((k,I)=>e.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Y,{className:"w-4 h-4 text-green-600"}),k]},I))})]},w.id))}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:i,className:"btn-primary flex-1",children:"Confirm Change"}),e.jsx("button",{onClick:()=>m(!1),className:"btn-secondary",children:"Cancel"})]})]})})]})}function Ht(){const[t,p]=c.useState([]),[n,m]=c.useState(!1),[r,o]=c.useState(null),[a,x]=c.useState({name:"",amount:"",description:"",active:!0});c.useEffect(()=>{u()},[]);const u=()=>{const l=JSON.parse(localStorage.getItem("serviceFees")||"[]");p(l)},f=l=>{localStorage.setItem("serviceFees",JSON.stringify(l)),p(l)},h=l=>{if(l.preventDefault(),r){const d=t.map(s=>s.id===r.id?{...a,id:s.id}:s);f(d)}else{const d={...a,id:Date.now(),createdAt:new Date().toISOString()};f([...t,d])}m(!1),o(null),x({name:"",amount:"",description:"",active:!0})},g=l=>{confirm("Delete this service fee?")&&f(t.filter(d=>d.id!==l))};return e.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Service Fees"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage delivery, packaging, and other fees"})]}),e.jsxs("button",{onClick:()=>{m(!0),o(null)},className:"btn-primary flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"}),"Add Fee"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:t.map(l=>e.jsxs("div",{className:`card ${l.active?"border-green-200 bg-green-50":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:e.jsx(ae,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:l.name}),e.jsx("p",{className:"text-xs text-gray-500",children:l.description})]})]}),e.jsx("span",{className:`badge ${l.active?"badge-success":"bg-gray-200 text-gray-600"}`,children:l.active?"Active":"Inactive"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["KSH ",l.amount]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{o(l),x(l),m(!0)},className:"p-2 hover:bg-blue-50 rounded-lg",children:e.jsx(ue,{className:"w-4 h-4 text-blue-600"})}),e.jsx("button",{onClick:()=>g(l.id),className:"p-2 hover:bg-red-50 rounded-lg",children:e.jsx(K,{className:"w-4 h-4 text-red-600"})})]})]})]},l.id))}),n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4",children:[r?"Edit":"Add"," Service Fee"]}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Fee Name (e.g., Delivery)",className:"input",value:a.name,onChange:l=>x({...a,name:l.target.value}),required:!0}),e.jsx("input",{type:"number",step:"0.01",placeholder:"Amount",className:"input",value:a.amount,onChange:l=>x({...a,amount:l.target.value}),required:!0}),e.jsx("textarea",{placeholder:"Description",className:"input",rows:"2",value:a.description,onChange:l=>x({...a,description:l.target.value})}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:a.active,onChange:l=>x({...a,active:l.target.checked})}),e.jsx("span",{className:"text-sm",children:"Active"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Save"}),e.jsx("button",{type:"button",onClick:()=>m(!1),className:"btn-secondary",children:"Cancel"})]})]})]})})]})}function Kt(){const[t,p]=c.useState([]),[n,m]=c.useState([]),[r,o]=c.useState(!1),[a,x]=c.useState({customerName:"",productId:"",frequency:"weekly",days:[],nextDate:""});c.useEffect(()=>{u(),f()},[]);const u=async()=>{try{const s=localStorage.getItem("token"),v=await(await fetch("/api/reminders",{headers:{Authorization:`Bearer ${s}`}})).json();p(v)}catch(s){console.error("Failed to fetch reminders:",s)}},f=async()=>{try{const s=localStorage.getItem("token"),v=await(await fetch("/api/products",{headers:{Authorization:`Bearer ${s}`}})).json();m(v)}catch(s){console.error("Failed to fetch products:",s)}},h=async s=>{s.preventDefault();try{const b=localStorage.getItem("token");await fetch("/api/reminders",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify(a)}),u(),o(!1),x({customerName:"",productId:"",frequency:"weekly",days:[],nextDate:""})}catch(b){console.error("Failed to create reminder:",b)}},g=async s=>{try{const b=localStorage.getItem("token");await fetch(`/api/reminders/${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${b}`}}),u()}catch(b){console.error("Failed to delete reminder:",b)}},l=s=>{a.days.includes(s)?x({...a,days:a.days.filter(b=>b!==s)}):x({...a,days:[...a.days,s]})},d=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[e.jsx(Ie,{className:"text-blue-600"}),"Reminder System"]}),e.jsxs("button",{onClick:()=>o(!0),className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-blue-700 transition flex items-center gap-2",children:[e.jsx(H,{size:20}),"New Reminder"]})]}),e.jsx("div",{className:"grid gap-4",children:t.map(s=>{var i;const b=n.find(v=>v.id===s.productId);return e.jsx("div",{className:`p-6 rounded-xl shadow-lg ${s.status==="pending"?"bg-red-50 border-l-4 border-red-500":"bg-green-50 border-l-4 border-green-500"}`,children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-2",children:s.customerName}),e.jsxs("p",{className:"text-gray-700 mb-1",children:["Product: ",(b==null?void 0:b.name)||"Unknown"]}),e.jsxs("p",{className:"text-gray-600 text-sm mb-1",children:["Frequency: ",s.frequency]}),((i=s.days)==null?void 0:i.length)>0&&e.jsxs("p",{className:"text-gray-600 text-sm mb-1",children:["Days: ",s.days.join(", ")]}),e.jsxs("p",{className:"text-gray-600 text-sm flex items-center gap-2",children:[e.jsx(xe,{size:16}),"Next: ",new Date(s.nextDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:`px-4 py-2 rounded-lg font-bold ${s.status==="pending"?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:s.status}),e.jsx("button",{onClick:()=>g(s.id),className:"bg-red-500 text-white p-2 rounded-lg hover:bg-red-600 transition",children:e.jsx(K,{size:20})})]})]})},s.id)})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white rounded-t-2xl",children:e.jsx("h2",{className:"text-2xl font-bold",children:"Create Reminder"})}),e.jsxs("form",{onSubmit:h,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Customer Name"}),e.jsx("input",{type:"text",value:a.customerName,onChange:s=>x({...a,customerName:s.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Product"}),e.jsxs("select",{value:a.productId,onChange:s=>x({...a,productId:parseInt(s.target.value)}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Select Product"}),n.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Frequency"}),e.jsxs("select",{value:a.frequency,onChange:s=>x({...a,frequency:s.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"specific",children:"Specific Days"})]})]}),a.frequency==="specific"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Days"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(s=>e.jsx("button",{type:"button",onClick:()=>l(s),className:`px-4 py-2 rounded-lg font-medium transition ${a.days.includes(s)?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Next Reminder Date"}),e.jsx("input",{type:"date",value:a.nextDate,onChange:s=>x({...a,nextDate:s.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700 transition",children:"Create Reminder"}),e.jsx("button",{type:"button",onClick:()=>o(!1),className:"px-6 bg-gray-200 text-gray-700 py-3 rounded-lg font-bold hover:bg-gray-300 transition",children:"Cancel"})]})]})]})})]})}function zt(){const[t,p]=c.useState([]),[n,m]=c.useState(!1),[r,o]=c.useState(null),[a,x]=c.useState({name:"",percentage:"",validFrom:"",validTo:"",active:!0});c.useEffect(()=>{u()},[]);const u=async()=>{try{const l=await ce.getAll();p(l)}catch(l){console.error("Failed to load discounts:",l)}},f=async l=>{l.preventDefault();try{r?await ce.update(r.id,a):await ce.create(a),m(!1),o(null),x({name:"",percentage:"",validFrom:"",validTo:"",active:!0}),u()}catch(d){console.error("Failed to save discount:",d)}},h=async l=>{if(confirm("Delete this discount?"))try{await ce.delete(l),u()}catch(d){console.error("Failed to delete discount:",d)}},g=l=>{const d=new Date,s=new Date(l.validFrom),b=new Date(l.validTo);return l.active&&s<=d&&b>=d};return e.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Discount Manager"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create and manage discount rules"})]}),e.jsxs("button",{onClick:()=>{m(!0),o(null),x({name:"",percentage:"",validFrom:"",validTo:"",active:!0})},className:"btn-primary flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"}),"Add Discount"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[t.map(l=>e.jsxs("div",{className:`card ${g(l)?"border-green-200 bg-green-50":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${g(l)?"bg-green-600":"bg-gray-400"}`,children:e.jsx(ve,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:l.name}),e.jsxs("p",{className:"text-2xl font-bold text-red-600",children:[l.percentage,"% OFF"]})]})]}),e.jsx("span",{className:`badge ${g(l)?"badge-success":"bg-gray-200 text-gray-600"}`,children:g(l)?"Active":"Inactive"})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4"}),e.jsxs("span",{children:["From: ",new Date(l.validFrom).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4"}),e.jsxs("span",{children:["To: ",new Date(l.validTo).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{o(l),x(l),m(!0)},className:"p-2 hover:bg-blue-50 rounded-lg flex-1",children:e.jsx(ue,{className:"w-4 h-4 text-blue-600 mx-auto"})}),e.jsx("button",{onClick:()=>h(l.id),className:"p-2 hover:bg-red-50 rounded-lg flex-1",children:e.jsx(K,{className:"w-4 h-4 text-red-600 mx-auto"})})]})]},l.id)),t.length===0&&e.jsxs("div",{className:"card text-center py-12 col-span-full",children:[e.jsx(ve,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No discounts yet. Create your first discount!"})]})]}),n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4",children:[r?"Edit":"Add"," Discount"]}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Discount Name"}),e.jsx("input",{type:"text",className:"input",value:a.name,onChange:l=>x({...a,name:l.target.value}),placeholder:"e.g., Holiday Sale",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Percentage (%)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",className:"input",value:a.percentage,onChange:l=>x({...a,percentage:parseFloat(l.target.value)}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Valid From"}),e.jsx("input",{type:"date",className:"input",value:a.validFrom,onChange:l=>x({...a,validFrom:l.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Valid To"}),e.jsx("input",{type:"date",className:"input",value:a.validTo,onChange:l=>x({...a,validTo:l.target.value}),required:!0})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:a.active,onChange:l=>x({...a,active:l.target.checked})}),e.jsx("span",{className:"text-sm",children:"Active"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Save"}),e.jsx("button",{type:"button",onClick:()=>m(!1),className:"btn-secondary",children:"Cancel"})]})]})]})})]})}function Jt(){const[t,p]=c.useState([]),[n,m]=c.useState([]),[r,o]=c.useState("all");c.useEffect(()=>{a(),x()},[]);const a=async()=>{try{const s=await fe.getAll();p(s)}catch(s){console.error("Failed to load credit requests:",s)}},x=async()=>{try{const s=await B.getAll();m(s)}catch(s){console.error("Failed to load products:",s)}},u=async s=>{try{await fe.approve(s),a()}catch(b){console.error("Failed to approve request:",b)}},f=async s=>{try{await fe.reject(s),a()}catch(b){console.error("Failed to reject request:",b)}},h=s=>{const b=n.find(i=>i.id===s);return b?b.name:"Unknown Product"},g=t.filter(s=>r==="all"?!0:s.status===r),l=s=>{switch(s){case"pending":return"bg-orange-50 border-orange-200";case"approved":return"bg-green-50 border-green-200";case"rejected":return"bg-red-50 border-red-200";default:return"bg-gray-50 border-gray-200"}},d=s=>{switch(s){case"pending":return e.jsx(Ae,{className:"w-6 h-6 text-orange-600"});case"approved":return e.jsx(se,{className:"w-6 h-6 text-green-600"});case"rejected":return e.jsx(we,{className:"w-6 h-6 text-red-600"});default:return e.jsx(te,{className:"w-6 h-6 text-gray-600"})}};return e.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Credit Requests"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Review and manage credit requests from cashiers"})]}),e.jsx("div",{className:"flex gap-2",children:["all","pending","approved","rejected"].map(s=>e.jsx("button",{onClick:()=>o(s),className:`px-4 py-2 rounded-lg font-medium transition ${r===s?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:s.charAt(0).toUpperCase()+s.slice(1)},s))})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[g.map(s=>{var b;return e.jsx("div",{className:`card border-l-4 ${l(s.status)}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${s.status==="pending"?"bg-orange-600":s.status==="approved"?"bg-green-600":"bg-red-600"}`,children:d(s.status)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.customerName}),e.jsx("p",{className:"text-sm text-gray-600",children:h(s.productId)}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm",children:[e.jsxs("span",{children:["Quantity: ",e.jsx("strong",{children:s.quantity})]}),e.jsxs("span",{children:["Amount: ",e.jsxs("strong",{className:"text-green-600",children:["KSH ",(b=s.amount)==null?void 0:b.toLocaleString()]})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Requested: ",new Date(s.createdAt).toLocaleString()]}),s.approvedAt&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Approved: ",new Date(s.approvedAt).toLocaleString()]})]})]}),s.status==="pending"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>u(s.id),className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition",children:[e.jsx(se,{size:16}),"Approve"]}),e.jsxs("button",{onClick:()=>f(s.id),className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition",children:[e.jsx(we,{size:16}),"Reject"]})]}),s.status!=="pending"&&e.jsx("span",{className:`badge ${s.status==="approved"?"badge-success":"bg-red-100 text-red-800"}`,children:s.status.toUpperCase()})]})},s.id)}),g.length===0&&e.jsxs("div",{className:"card text-center py-12",children:[e.jsx(te,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsxs("p",{className:"text-gray-500",children:["No ",r!=="all"?r:""," credit requests found."]})]})]})]})}function _t({onClose:t}){const[p,n]=c.useState([]),[m,r]=c.useState(!0);c.useEffect(()=>{o()},[]);const o=async()=>{try{const x=localStorage.getItem("token"),h=await(await fetch("/api/reminders/today",{headers:{Authorization:`Bearer ${x}`}})).json();n(h)}catch(x){console.error("Failed to fetch reminders:",x)}finally{r(!1)}},a=async x=>{try{const u=localStorage.getItem("token");await fetch(`/api/reminders/${x}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`},body:JSON.stringify({status:"fulfilled"})}),o()}catch(u){console.error("Failed to update reminder:",u)}};return m||p.length===0?null:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Today's Reminders"}),e.jsx("button",{onClick:t,className:"hover:bg-white/20 p-2 rounded-lg transition",children:e.jsx(Ce,{size:24})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:p.map(x=>e.jsxs("div",{className:"mb-4 p-4 border-l-4 border-red-500 bg-red-50 rounded-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:x.customerName}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Product ID: ",x.productId]}),e.jsx("p",{className:"text-xs text-gray-500",children:x.frequency})]}),e.jsxs("button",{onClick:()=>a(x.id),className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition",children:[e.jsx(se,{size:18}),"Mark Done"]})]},x.id))})]})})}function Gt({onUnlock:t,logo:p}){const[n,m]=c.useState(""),[r,o]=c.useState(""),a=x=>{x.preventDefault();const u=JSON.parse(localStorage.getItem("user"));n===u.password||n==="1234"?(t(),m(""),o("")):(o("Invalid PIN"),m(""))};return e.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-900 via-purple-900 to-pink-900 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white/10 backdrop-blur-xl rounded-3xl p-12 shadow-2xl max-w-md w-full mx-4",children:[p?e.jsx("img",{src:p,alt:"Logo",className:"w-32 h-32 mx-auto mb-8 rounded-2xl shadow-lg"}):e.jsx("div",{className:"w-32 h-32 mx-auto mb-8 bg-white/20 rounded-2xl flex items-center justify-center",children:e.jsx(G,{size:64,className:"text-white"})}),e.jsx("h2",{className:"text-3xl font-bold text-white text-center mb-2",children:"Screen Locked"}),e.jsx("p",{className:"text-white/70 text-center mb-8",children:"Enter your PIN to unlock"}),e.jsxs("form",{onSubmit:a,children:[e.jsx("input",{type:"password",value:n,onChange:x=>m(x.target.value),className:"w-full px-6 py-4 rounded-xl bg-white/20 text-white placeholder-white/50 text-center text-2xl tracking-widest focus:outline-none focus:ring-4 focus:ring-white/30",placeholder:"â€¢â€¢â€¢â€¢",autoFocus:!0}),r&&e.jsx("p",{className:"text-red-300 text-center mt-4",children:r}),e.jsx("button",{type:"submit",className:"w-full mt-6 bg-white text-purple-900 py-4 rounded-xl font-bold text-lg hover:bg-white/90 transition shadow-lg",children:"Unlock"})]})]})})}function Wt(t=45e3){const[p,n]=c.useState(!1);let m;const r=()=>{clearTimeout(m),m=setTimeout(()=>n(!0),t)};return c.useEffect(()=>{const o=["mousedown","mousemove","keypress","scroll","touchstart","click"];return o.forEach(a=>{document.addEventListener(a,r,!0)}),r(),()=>{clearTimeout(m),o.forEach(a=>{document.removeEventListener(a,r,!0)})}},[]),[p,()=>n(!1)]}function Vt(){var b,i;const{user:t,logout:p}=z(),n=Q(),m=rt(),[r,o]=c.useState(!0),[a,x]=c.useState(!1),[u,f]=Wt(45e3),[h,g]=c.useState({});c.useEffect(()=>{const v=()=>{const w=localStorage.getItem("user");if(w){const k=JSON.parse(w);let I=!1;(k.plan==="ultra"||k.role==="admin")&&(k.active||(k.active=!0,I=!0),k.plan==="ultra"&&k.role!=="admin"&&(k.role="admin",I=!0),k.plan==="ultra"&&(!k.price||k.price!==1600)&&(k.price=1600,I=!0),I&&(localStorage.setItem("user",JSON.stringify(k)),window.dispatchEvent(new Event("storage")),window.dispatchEvent(new Event("localStorageUpdated"))))}};v(),setTimeout(v,100),x(!0),l()},[]);const l=async()=>{try{const v=await ke.get();g(v)}catch(v){console.error("Failed to load settings:",v)}},d=[{id:"overview",label:"Dashboard",icon:gt,path:"/admin"},{id:"sales",label:"Sales",icon:Je,path:"/admin/sales"},{id:"inventory",label:"Inventory",icon:V,path:"/admin/inventory"},{id:"recipes",label:"Recipes/BOM",icon:Be,path:"/admin/recipes"},{id:"expenses",label:"Expenses",icon:_e,path:"/admin/expenses"},{id:"users",label:"Users",icon:de,path:"/admin/users"},{id:"time",label:"Time Tracking",icon:Ae,path:"/admin/time"},{id:"reminders",label:"Reminders",icon:Ie,path:"/admin/reminders"},{id:"service-fees",label:"Service Fees",icon:ae,path:"/admin/service-fees"},{id:"discounts",label:"Discounts",icon:ve,path:"/admin/discounts"},{id:"credit-requests",label:"Credit Requests",icon:te,path:"/admin/credit-requests"},{id:"settings",label:"Settings",icon:We,path:"/admin/settings"}],s=v=>v==="/admin"?m.pathname==="/admin":m.pathname.startsWith(v);return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[e.jsxs("aside",{className:`bg-white border-r border-gray-200 transition-all duration-300 ${r?"w-64":"w-20"} flex flex-col`,children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[r&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Admin Panel"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ultra Package"})]}),e.jsx("button",{onClick:()=>o(!r),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:r?e.jsx(Ce,{className:"w-5 h-5"}):e.jsx(pt,{className:"w-5 h-5"})})]})}),e.jsx("nav",{className:"flex-1 p-4 space-y-2",children:d.map(v=>{const w=v.icon;return e.jsxs("button",{onClick:()=>n(v.path),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all ${s(v.path)?"bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-md":"text-gray-700 hover:bg-gray-100"}`,children:[e.jsx(w,{className:"w-5 h-5 flex-shrink-0"}),r&&e.jsx("span",{className:"font-medium",children:v.label})]},v.id)})}),e.jsxs("div",{className:"p-4 border-t border-gray-200 space-y-2",children:[e.jsxs("button",{onClick:()=>window.open("/cashier","_blank"),className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors",children:[e.jsx(bt,{className:"w-5 h-5 flex-shrink-0"}),r&&e.jsx("span",{className:"font-medium",children:"Open POS"})]}),e.jsxs("button",{onClick:p,className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-red-600 hover:bg-red-50 transition-colors",children:[e.jsx(oe,{className:"w-5 h-5 flex-shrink-0"}),r&&e.jsx("span",{className:"font-medium",children:"Logout"})]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:((b=d.find(v=>s(v.path)))==null?void 0:b.label)||"Dashboard"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:t==null?void 0:t.name}),e.jsx("p",{className:"text-xs text-gray-500",children:t==null?void 0:t.email})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center text-white font-bold",children:(i=t==null?void 0:t.name)==null?void 0:i.charAt(0).toUpperCase()})]})]})}),e.jsx("main",{className:"flex-1 overflow-auto",children:e.jsxs(Me,{children:[e.jsx(F,{path:"/",element:e.jsx(Ut,{})}),e.jsx(F,{path:"/sales",element:e.jsx(Ft,{})}),e.jsx(F,{path:"/inventory",element:e.jsx(Tt,{})}),e.jsx(F,{path:"/recipes",element:e.jsx(Rt,{})}),e.jsx(F,{path:"/expenses",element:e.jsx($t,{})}),e.jsx(F,{path:"/reminders",element:e.jsx(Kt,{})}),e.jsx(F,{path:"/service-fees",element:e.jsx(Ht,{})}),e.jsx(F,{path:"/discounts",element:e.jsx(zt,{})}),e.jsx(F,{path:"/credit-requests",element:e.jsx(Jt,{})}),e.jsx(F,{path:"/users",element:e.jsx(qt,{})}),e.jsx(F,{path:"/time",element:e.jsx(Mt,{})}),e.jsx(F,{path:"/settings",element:e.jsx(Bt,{})})]})})]}),a&&e.jsx(_t,{onClose:()=>x(!1)}),u&&e.jsx(Gt,{onUnlock:f,logo:h.logo})]})}function Yt(){var Ee,De,Oe;const{user:t,logout:p}=z(),[n,m]=c.useState([]),[r,o]=c.useState([]),[a,x]=c.useState("cash"),[u,f]=c.useState(!0),[h,g]=c.useState("pos"),[l,d]=c.useState(!1),[s,b]=c.useState(null),[i,v]=c.useState({name:"",price:"",quantity:"",unit:"pcs"}),[w,k]=c.useState(""),[I,q]=c.useState([]),[M,Z]=c.useState({}),[J,j]=c.useState(!1),[T,$]=c.useState(null);c.useEffect(()=>{C();const N=localStorage.getItem(`clockIn_${t==null?void 0:t.id}_${new Date().toDateString()}`);N&&(j(!0),$(new Date(N)))},[]);const y=()=>{const N=new Date;localStorage.setItem(`clockIn_${t==null?void 0:t.id}_${N.toDateString()}`,N.toISOString()),j(!0),$(N)},S=()=>{const N=new Date,D=localStorage.getItem(`clockIn_${t==null?void 0:t.id}_${new Date().toDateString()}`);if(D){const U=new Date(D),re=Math.floor((N-U)/1e3/60),Le=JSON.parse(localStorage.getItem("clockRecords")||"[]");Le.push({userId:t==null?void 0:t.id,userName:t==null?void 0:t.name,clockIn:U.toISOString(),clockOut:N.toISOString(),duration:re,date:new Date().toDateString()}),localStorage.setItem("clockRecords",JSON.stringify(Le)),localStorage.removeItem(`clockIn_${t==null?void 0:t.id}_${new Date().toDateString()}`)}j(!1),$(null)},C=async()=>{const[N,D,U]=await Promise.all([B.getAll(),me.getAll(),Ze.get()]);m(N),q(D.reverse()),Z(U)},P=N=>{const D=r.find(U=>U.id===N.id);o(D?r.map(U=>U.id===N.id?{...U,quantity:U.quantity+1}:U):[...r,{...N,quantity:1}])},L=(N,D)=>{o(r.map(U=>U.id===N?{...U,quantity:Math.max(1,U.quantity+D)}:U).filter(U=>U.quantity>0))},A=N=>{o(r.filter(D=>D.id!==N))},R=r.reduce((N,D)=>N+D.price*D.quantity,0),E=u?0:R*.16,le=R+E,et=async()=>{if(r.length!==0)try{await me.create({items:r.map(N=>({productId:N.id,quantity:N.quantity,price:N.price})),total:le,paymentMethod:a}),o([]),C(),alert("Sale completed successfully!")}catch(N){alert("Failed to complete sale: "+N.message)}},tt=n.filter(N=>{var D;return(D=N.name)==null?void 0:D.toLowerCase().includes(w.toLowerCase())});return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex flex-col",children:[e.jsx("nav",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200 px-4 md:px-6 py-3 md:py-4 sticky top-0 z-50 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg md:text-2xl font-bold bg-gradient-to-r from-green-600 to-teal-600 bg-clip-text text-transparent",children:(t==null?void 0:t.plan)==="basic"?"Cashier Dashboard":"POS System"}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5 hidden md:block",children:(t==null?void 0:t.plan)==="basic"?"Basic Package - KSH 900/month":"Ultra Package Access"})]}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e.jsxs("div",{className:"text-right hidden md:block",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t==null?void 0:t.name}),e.jsx("p",{className:"text-xs text-gray-500",children:t==null?void 0:t.email}),J&&T&&e.jsxs("p",{className:"text-xs text-green-600 font-medium",children:["Clocked in: ",T.toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[J?e.jsxs("button",{onClick:S,className:"btn-secondary flex items-center gap-1 md:gap-2 text-sm md:text-base px-2 md:px-4 bg-red-50 text-red-600 border-red-200",children:[e.jsx(oe,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden md:inline",children:"Clock Out"})]}):e.jsxs("button",{onClick:y,className:"btn-secondary flex items-center gap-1 md:gap-2 text-sm md:text-base px-2 md:px-4 bg-green-50 text-green-600 border-green-200",children:[e.jsx(oe,{className:"w-4 h-4 rotate-180"}),e.jsx("span",{className:"hidden md:inline",children:"Clock In"})]}),e.jsxs("button",{onClick:()=>window.location.href="/cashier/settings",className:"btn-secondary flex items-center gap-1 md:gap-2 text-sm md:text-base px-2 md:px-4",children:[e.jsx(We,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden md:inline",children:"Settings"})]}),e.jsxs("button",{onClick:p,className:"btn-secondary flex items-center gap-1 md:gap-2 hover:bg-red-50 hover:text-red-600 hover:border-red-200 text-sm md:text-base px-2 md:px-4",children:[e.jsx(oe,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden md:inline",children:"Logout"})]})]})]})]})}),e.jsxs("div",{className:"flex gap-1 md:gap-2 px-2 md:px-6 py-2 md:py-4 bg-white border-b border-gray-200 overflow-x-auto",children:[e.jsxs("button",{onClick:()=>g("pos"),className:`px-3 md:px-6 py-2 rounded-lg font-medium transition-all whitespace-nowrap text-sm md:text-base ${h==="pos"?"bg-gradient-to-r from-green-600 to-teal-600 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(ge,{className:"w-4 h-4 inline mr-1 md:mr-2"}),"POS"]}),e.jsxs("button",{onClick:()=>g("sales"),className:`px-3 md:px-6 py-2 rounded-lg font-medium transition-all whitespace-nowrap text-sm md:text-base ${h==="sales"?"bg-gradient-to-r from-green-600 to-teal-600 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(je,{className:"w-4 h-4 inline mr-1 md:mr-2"}),"Sales"]}),e.jsxs("button",{onClick:()=>g("stock"),className:`px-3 md:px-6 py-2 rounded-lg font-medium transition-all whitespace-nowrap text-sm md:text-base ${h==="stock"?"bg-gradient-to-r from-green-600 to-teal-600 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(V,{className:"w-4 h-4 inline mr-1 md:mr-2"}),"Stock"]})]}),h==="pos"&&e.jsxs("div",{className:"flex-1 flex flex-col md:flex-row",children:[e.jsxs("div",{className:"flex-1 p-3 md:p-6 overflow-y-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(Pe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search products...",className:"input pl-10",value:w,onChange:N=>k(N.target.value)})]})}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-4",children:tt.map(N=>{var D,U;return e.jsxs("button",{onClick:()=>P(N),className:"card text-left hover:shadow-xl transition-all transform hover:scale-105 bg-gradient-to-br from-white to-gray-50",disabled:N.quantity===0,children:[e.jsx("h3",{className:"font-semibold mb-2 text-gray-900",children:N.name}),e.jsxs("p",{className:"text-xl font-bold text-green-600",children:["KSH ",(D=N.price)==null?void 0:D.toLocaleString()]}),((U=t==null?void 0:t.permissions)==null?void 0:U.viewInventory)&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Stock: ",N.quantity||0," ",N.unit]}),N.quantity===0&&e.jsx("span",{className:"text-xs text-red-600 font-medium",children:"Out of Stock"})]},N.id)})})]}),e.jsxs("div",{className:"w-full md:w-96 bg-white border-t md:border-l md:border-t-0 border-gray-200 p-4 md:p-6 flex flex-col shadow-xl max-h-[50vh] md:max-h-none",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-600 to-teal-600 rounded-xl flex items-center justify-center",children:e.jsx(ge,{className:"w-5 h-5 text-white"})}),e.jsx("h2",{className:"text-xl font-semibold",children:"Cart"}),e.jsxs("span",{className:"ml-auto bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-semibold",children:[r.length," items"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto mb-6",children:r.length===0?e.jsxs("div",{className:"text-center mt-16",children:[e.jsx(ge,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Cart is empty"})]}):e.jsx("div",{className:"space-y-3",children:r.map(N=>e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:N.name}),e.jsx("button",{onClick:()=>A(N.id),className:"text-red-600 hover:bg-red-50 p-1 rounded",children:e.jsx(K,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>L(N.id,-1),className:"w-8 h-8 rounded-lg bg-white shadow-sm flex items-center justify-center hover:bg-gray-100",children:e.jsx(ft,{className:"w-4 h-4"})}),e.jsx("span",{className:"w-10 text-center font-semibold",children:N.quantity}),e.jsx("button",{onClick:()=>L(N.id,1),className:"w-8 h-8 rounded-lg bg-white shadow-sm flex items-center justify-center hover:bg-gray-100",children:e.jsx(H,{className:"w-4 h-4"})})]}),e.jsxs("span",{className:"font-bold text-green-600",children:["KSH ",(N.price*N.quantity).toLocaleString()]})]})]},N.id))})}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 space-y-4",children:[e.jsxs("div",{className:"space-y-2 border-t border-gray-200 pt-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Subtotal:"}),e.jsxs("span",{className:"font-semibold",children:["KSH ",R.toLocaleString()]})]}),!u&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Tax (16%):"}),e.jsxs("span",{className:"font-semibold",children:["KSH ",E.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between text-xl font-bold border-t border-gray-200 pt-2",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{className:"text-green-600",children:["KSH ",le.toLocaleString()]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Tax"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f(!0),className:`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all ${u?"bg-green-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Tax Inclusive"}),e.jsx("button",{onClick:()=>f(!1),className:`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all ${u?"bg-gray-100 text-gray-600 hover:bg-gray-200":"bg-green-600 text-white"}`,children:"Tax Exclusive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Payment Method"}),e.jsxs("select",{value:a,onChange:N=>x(N.target.value),className:"input",children:[e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"mpesa",children:"M-Pesa"}),e.jsx("option",{value:"card",children:"Card"})]})]}),e.jsx("button",{onClick:et,disabled:r.length===0,className:"btn-primary w-full py-4 text-lg bg-gradient-to-r from-green-600 to-teal-600 hover:from-green-700 hover:to-teal-700 shadow-lg",children:"Complete Sale"})]})]})]}),h==="stock"&&e.jsxs("div",{className:"p-6 max-w-7xl mx-auto w-full space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Stock Management"}),e.jsxs("button",{onClick:()=>{d(!0),v({name:"",price:"",quantity:"",unit:"pcs"})},className:"btn-primary flex items-center gap-2 bg-gradient-to-r from-green-600 to-teal-600",children:[e.jsx(H,{className:"w-4 h-4"}),"Add Product"]})]}),e.jsx("div",{className:"card shadow-lg",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Product"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Price"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Stock"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:n.map(N=>{var D;return e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:N.name}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-green-600",children:["KSH ",(D=N.price)==null?void 0:D.toLocaleString()]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("span",{className:`font-medium ${N.quantity<10?"text-red-600":"text-gray-900"}`,children:[N.quantity," ",N.unit]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{b(N),v({name:N.name,price:N.price,quantity:N.quantity,unit:N.unit||"pcs"})},className:"p-2 hover:bg-green-50 rounded-lg text-green-600",children:e.jsx(ue,{className:"w-4 h-4"})}),e.jsx("button",{onClick:async()=>{confirm("Delete this product?")&&(await B.delete(N.id),C())},className:"p-2 hover:bg-red-50 rounded-lg text-red-600",children:e.jsx(K,{className:"w-4 h-4"})})]})})]},N.id)})})]})})}),(l||s)&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:s?"Edit Product":"Add Product"}),e.jsxs("form",{onSubmit:async N=>{N.preventDefault();try{s?await B.update(s.id,{...s,...i,price:parseFloat(i.price),quantity:parseFloat(i.quantity)}):await B.create({...i,price:parseFloat(i.price),cost:parseFloat(i.price)*.6,quantity:parseFloat(i.quantity),category:"raw"}),d(!1),b(null),C()}catch(D){alert("Failed: "+D.message)}},className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Product Name",className:"input",value:i.name,onChange:N=>v({...i,name:N.target.value}),required:!0}),e.jsx("input",{type:"number",step:"0.01",placeholder:"Price",className:"input",value:i.price,onChange:N=>v({...i,price:N.target.value}),required:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("input",{type:"number",step:"0.01",placeholder:"Quantity",className:"input",value:i.quantity,onChange:N=>v({...i,quantity:N.target.value}),required:!0}),e.jsxs("select",{className:"input",value:i.unit,onChange:N=>v({...i,unit:N.target.value}),children:[e.jsx("option",{value:"pcs",children:"Pieces"}),e.jsx("option",{value:"kg",children:"Kilograms"}),e.jsx("option",{value:"L",children:"Liters"}),e.jsx("option",{value:"g",children:"Grams"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:s?"Update":"Add"}),e.jsx("button",{type:"button",onClick:()=>{d(!1),b(null)},className:"btn-secondary",children:"Cancel"})]})]})]})})]}),h==="sales"&&e.jsxs("div",{className:"p-6 max-w-7xl mx-auto w-full space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"card bg-gradient-to-br from-green-500 to-emerald-600 text-white border-0 shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-100 mb-1",children:"Daily Sales"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",((Ee=M.dailySales)==null?void 0:Ee.toLocaleString())||0]})]}),e.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:e.jsx(ae,{className:"w-8 h-8"})})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-blue-500 to-indigo-600 text-white border-0 shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-100 mb-1",children:"Weekly Sales"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",((De=M.weeklySales)==null?void 0:De.toLocaleString())||0]})]}),e.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:e.jsx(ee,{className:"w-8 h-8"})})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-purple-500 to-pink-600 text-white border-0 shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-purple-100 mb-1",children:"Total Sales"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",((Oe=M.totalSales)==null?void 0:Oe.toLocaleString())||0]})]}),e.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:e.jsx(V,{className:"w-8 h-8"})})]})})]}),e.jsxs("div",{className:"card shadow-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Sales History"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Date & Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Items"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Payment"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Total"}),(t==null?void 0:t.plan)==="ultra"&&e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Profit"})]})}),e.jsx("tbody",{children:I.slice(0,20).map(N=>{var D,U,re;return e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(N.createdAt).toLocaleString()}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[((D=N.items)==null?void 0:D.length)||0," items"]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"badge badge-success",children:N.paymentMethod||"cash"})}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-green-600",children:["KSH ",(U=N.total)==null?void 0:U.toLocaleString()]}),(t==null?void 0:t.plan)==="ultra"&&e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-blue-600",children:["KSH ",((re=N.profit)==null?void 0:re.toLocaleString())||0]})]},N.id)})})]})})]})]})]})}function Qt(){const{user:t,updateUser:p,logout:n}=z(),m=Q(),[r,o]=c.useState(!1),[a,x]=c.useState((t==null?void 0:t.plan)||"basic"),u=[{id:"basic",name:"Basic Package",price:900,features:["Cashier Dashboard","Sales Tracking","Product Management","Basic Reports"]},{id:"ultra",name:"Ultra Package",price:1600,features:["Admin Dashboard","Recipe Builder","User Management","Advanced Analytics","Expense Tracking"]}],f=async()=>{const h=u.find(l=>l.id===a),g=a==="ultra"?"admin":"cashier";await p({...t,role:g,plan:a,price:h.price}),o(!1),setTimeout(()=>window.location.href=g==="admin"?"/admin":"/cashier",500)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[e.jsx("nav",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200 px-6 py-4 sticky top-0 z-50 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>m("/cashier"),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(jt,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Settings"})]}),e.jsx("button",{onClick:n,className:"btn-secondary",children:"Logout"})]})}),e.jsx("div",{className:"p-6 max-w-6xl mx-auto space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx(he,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Account Information"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Name"}),e.jsx("p",{className:"font-medium",children:t==null?void 0:t.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Email"}),e.jsx("p",{className:"font-medium",children:t==null?void 0:t.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Role"}),e.jsx("p",{className:"font-medium capitalize",children:t==null?void 0:t.role})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx(te,{className:"w-5 h-5 text-purple-600"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Subscription"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Current Plan"}),e.jsxs("p",{className:"font-medium capitalize",children:[t==null?void 0:t.plan," Package"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Price"}),e.jsxs("p",{className:"font-medium",children:["KSH ",t==null?void 0:t.price,"/month"]})]}),e.jsx("button",{onClick:()=>o(!0),className:"btn-primary text-sm w-full",children:"Change Plan"})]})]})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-6",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-2xl font-bold mb-6",children:"Change Your Plan"}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:u.map(h=>e.jsxs("div",{onClick:()=>x(h.id),className:`card cursor-pointer transition-all ${a===h.id?"ring-4 ring-blue-600 bg-blue-50":"hover:shadow-lg"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-xl font-bold",children:h.name}),a===h.id&&e.jsx(Y,{className:"w-6 h-6 text-blue-600"})]}),e.jsxs("p",{className:"text-3xl font-bold mb-4",children:["KSH ",h.price,e.jsx("span",{className:"text-sm text-gray-600",children:"/month"})]}),e.jsx("ul",{className:"space-y-2",children:h.features.map((g,l)=>e.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Y,{className:"w-4 h-4 text-green-600"}),g]},l))})]},h.id))}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:f,className:"btn-primary flex-1",children:"Confirm Change"}),e.jsx("button",{onClick:()=>o(!1),className:"btn-secondary",children:"Cancel"})]})]})})]})}function Zt(){const[t,p]=c.useState([]),[n,m]=c.useState([]),[r,o]=c.useState("all"),[a,x]=c.useState(""),[u,f]=c.useState(!1),[h,g]=c.useState([]),[l,d]=c.useState({subject:"",message:""}),[s,b]=c.useState(!0),[i,v]=c.useState(null),[w,k]=c.useState({totalUsers:0,activeUsers:0,lockedUsers:0,totalRevenue:0,pendingPayments:0,overduePayments:0});c.useEffect(()=>{I().finally(()=>b(!1))},[]);const I=async()=>{try{const y=localStorage.getItem("token"),S="/api";try{const C=await fetch(`${S}/main-admin/users`,{headers:{Authorization:`Bearer ${y}`}});if(C.ok){const P=await C.json();p(P)}else{const P=await fetch(`${S}/users`,{headers:{Authorization:`Bearer ${y}`}});if(P.ok){const L=await P.json();p(L)}}}catch{console.log("Users endpoint not available, using empty data"),p([])}try{const C=await fetch(`${S}/main-admin/payments`,{headers:{Authorization:`Bearer ${y}`}});if(C.ok){const P=await C.json();m(P)}}catch{console.log("Payments endpoint not available, using empty data"),m([])}if(t.length===0){const C=q();p(C),M(C,[])}else M(t,n)}catch(y){console.error("Failed to load data:",y);{const S=q();p(S),M(S,[])}}},q=()=>{const y=localStorage.getItem("user"),S=[];if(y){const P=JSON.parse(y);S.push(P)}return[{name:"John Doe",email:"john@example.com",plan:"ultra",price:1600,active:!0,locked:!1},{name:"Jane Smith",email:"jane@example.com",plan:"basic",price:900,active:!0,locked:!1},{name:"Bob Wilson",email:"bob@example.com",plan:"ultra",price:1600,active:!1,locked:!1},{name:"Alice Brown",email:"alice@example.com",plan:"basic",price:900,active:!0,locked:!0}].forEach((P,L)=>{S.find(A=>A.email===P.email)||S.push({id:Date.now()+L,...P,role:P.plan==="ultra"?"admin":"cashier",createdAt:new Date(Date.now()-L*864e5).toISOString()})}),S},M=(y,S)=>{const C=y.length,P=y.filter(E=>E.active).length,L=y.filter(E=>E.locked).length,A=S.filter(E=>E.status==="paid").reduce((E,le)=>E+le.amount,0),R=S.filter(E=>E.status==="pending").length,_=S.filter(E=>E.status==="overdue").length;k({totalUsers:C,activeUsers:P,lockedUsers:L,totalRevenue:A,pendingPayments:R,overduePayments:_})},Z=async(y,S)=>{try{const C=localStorage.getItem("token"),P="/api";try{if((await fetch(`${P}/main-admin/users/${y}/lock`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`},body:JSON.stringify({locked:!S})})).ok){I();return}}catch{console.warn("Backend not available, using client-side update")}const L=t.map(R=>R.id===y?{...R,locked:!S,active:S}:R);p(L),M(L,n);const A=localStorage.getItem("user");if(A){const R=JSON.parse(A);R.id===y&&(R.locked=!S,R.active=S,localStorage.setItem("user",JSON.stringify(R)))}}catch(C){console.error("Failed to toggle lock:",C),alert("Failed to update user lock status.")}},J=async(y,S,C)=>{try{const P=localStorage.getItem("token"),L="/api";try{if((await fetch(`${L}/main-admin/send-email`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${P}`},body:JSON.stringify({userIds:y,subject:S,message:C})})).ok){alert("Emails sent successfully!"),f(!1),g([]),d({subject:"",message:""});return}}catch{console.warn("Backend not available, simulating email send")}const A=t.filter(E=>y.includes(E.id)),R={timestamp:new Date().toISOString(),recipients:A.map(E=>({id:E.id,name:E.name,email:E.email})),subject:S,message:C,status:"simulated"},_=JSON.parse(localStorage.getItem("emailLogs")||"[]");_.push(R),localStorage.setItem("emailLogs",JSON.stringify(_)),alert(`Email simulated successfully!

Sent to ${A.length} user(s):
${A.map(E=>E.email).join(", ")}

Note: Deploy backend to send real emails.`),f(!1),g([]),d({subject:"",message:""})}catch(P){console.error("Failed to send email:",P),alert("Failed to process email request.")}},j=async y=>{var C;const S=t.find(P=>P.id===y);S&&await J([y],"Payment Reminder - Subscription Upgrade",`Dear ${S.name},

This is a friendly reminder about your pending subscription payment for ${(C=S.plan)==null?void 0:C.toUpperCase()} plan (KSH ${S.price}).

Please complete your payment to continue enjoying our services.

Thank you!`)},T=t.filter(y=>{var C,P;const S=((C=y.name)==null?void 0:C.toLowerCase().includes(a.toLowerCase()))||((P=y.email)==null?void 0:P.toLowerCase().includes(a.toLowerCase()));if(r==="all")return S;if(r==="active")return S&&y.active&&!y.locked;if(r==="locked")return S&&y.locked;if(r==="pending-payment"){const L=n.filter(A=>A.userId===y.id&&A.status==="pending");return S&&L.length>0}if(r==="overdue"){const L=n.filter(A=>A.userId===y.id&&A.status==="overdue");return S&&L.length>0}return S}),$=y=>{const S=n.filter(A=>A.userId===y),C=S.filter(A=>A.status==="pending").length,P=S.filter(A=>A.status==="overdue").length,L=S.filter(A=>A.status==="paid").length;return{pending:C,overdue:P,paid:L,total:S.length}};return s?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-blue-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-white mx-auto mb-4"}),e.jsx("p",{className:"text-white text-xl",children:"Loading Main Admin Dashboard..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-blue-900",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 text-white px-6 py-3 text-center",children:e.jsxs("p",{className:"text-sm md:text-base font-semibold",children:["âš ï¸ Demo Mode: Backend not deployed. Actions are simulated locally.",e.jsx("a",{href:"/BACKEND_NOT_DEPLOYED.md",className:"underline ml-2",children:"Deploy Backend â†’"})]})}),e.jsx("header",{className:"bg-black/30 backdrop-blur-lg border-b border-white/10 px-6 py-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Main Admin Dashboard"}),e.jsx("p",{className:"text-gray-300",children:"Monitor all users, payments, and system activity"})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(de,{className:"w-8 h-8 text-blue-400"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:w.totalUsers})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Total Users"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(se,{className:"w-8 h-8 text-green-400"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:w.activeUsers})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Active Users"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(G,{className:"w-8 h-8 text-red-400"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:w.lockedUsers})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Locked Users"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(ae,{className:"w-8 h-8 text-yellow-400"}),e.jsxs("span",{className:"text-2xl font-bold text-white",children:["KSH ",w.totalRevenue.toLocaleString()]})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Total Revenue"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Ge,{className:"w-8 h-8 text-orange-400"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:w.pendingPayments})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Pending Payments"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(we,{className:"w-8 h-8 text-red-400"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:w.overduePayments})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Overdue Payments"})]})]}),e.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex gap-4 flex-1 w-full md:w-auto",children:[e.jsxs("div",{className:"relative flex-1 md:w-80",children:[e.jsx(Pe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search users...",className:"w-full pl-10 pr-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",value:a,onChange:y=>x(y.target.value)})]}),e.jsxs("select",{value:r,onChange:y=>o(y.target.value),className:"px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Users"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"locked",children:"Locked"}),e.jsx("option",{value:"pending-payment",children:"Pending Payment"}),e.jsx("option",{value:"overdue",children:"Overdue"})]})]}),e.jsxs("button",{onClick:()=>f(!0),disabled:h.length===0,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-6 py-3 rounded-lg font-bold flex items-center gap-2 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ye,{className:"w-5 h-5"}),"Send Email to Selected (",h.length,")"]})]})}),e.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-black/30",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-4 text-left",children:e.jsx("input",{type:"checkbox",checked:h.length===T.length&&T.length>0,onChange:y=>{y.target.checked?g(T.map(S=>S.id)):g([])},className:"w-5 h-5 rounded"})}),e.jsx("th",{className:"px-4 py-4 text-left text-sm font-semibold text-gray-200",children:"User"}),e.jsx("th",{className:"px-4 py-4 text-left text-sm font-semibold text-gray-200",children:"Plan"}),e.jsx("th",{className:"px-4 py-4 text-left text-sm font-semibold text-gray-200",children:"Status"}),e.jsx("th",{className:"px-4 py-4 text-left text-sm font-semibold text-gray-200",children:"Payments"}),e.jsx("th",{className:"px-4 py-4 text-left text-sm font-semibold text-gray-200",children:"Joined"}),e.jsx("th",{className:"px-4 py-4 text-left text-sm font-semibold text-gray-200",children:"Actions"})]})}),e.jsxs("tbody",{children:[T.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:"7",className:"px-4 py-12 text-center",children:[e.jsx(de,{className:"w-16 h-16 text-gray-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400 text-lg",children:"No users found"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:a||r!=="all"?"Try adjusting your filters":"Users will appear here once they sign up"})]})}),T.map(y=>{var C,P;const S=$(y.id);return e.jsxs("tr",{className:"border-t border-white/10 hover:bg-white/5 transition",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("input",{type:"checkbox",checked:h.includes(y.id),onChange:L=>{L.target.checked?g([...h,y.id]):g(h.filter(A=>A!==y.id))},className:"w-5 h-5 rounded"})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[y.profilePicture?e.jsx("img",{src:y.profilePicture,alt:y.name,className:"w-10 h-10 rounded-full"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center text-white font-bold",children:(C=y.name)==null?void 0:C.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-white",children:y.name}),e.jsx("p",{className:"text-sm text-gray-400",children:y.email})]})]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${y.plan==="ultra"?"bg-purple-500/20 text-purple-300":"bg-blue-500/20 text-blue-300"}`,children:[(P=y.plan)==null?void 0:P.toUpperCase()," - KSH ",y.price]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"flex items-center gap-2",children:y.locked?e.jsxs("span",{className:"px-3 py-1 rounded-full text-xs font-bold bg-red-500/20 text-red-300 flex items-center gap-1",children:[e.jsx(G,{className:"w-3 h-3"}),"Locked"]}):y.active?e.jsxs("span",{className:"px-3 py-1 rounded-full text-xs font-bold bg-green-500/20 text-green-300 flex items-center gap-1",children:[e.jsx(se,{className:"w-3 h-3"}),"Active"]}):e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-bold bg-gray-500/20 text-gray-300",children:"Inactive"})})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"space-y-1",children:[S.paid>0&&e.jsxs("span",{className:"text-xs text-green-400",children:["âœ“ ",S.paid," Paid"]}),S.pending>0&&e.jsxs("span",{className:"text-xs text-orange-400 block",children:["â³ ",S.pending," Pending"]}),S.overdue>0&&e.jsxs("span",{className:"text-xs text-red-400 block",children:["âš  ",S.overdue," Overdue"]})]})}),e.jsx("td",{className:"px-4 py-4 text-sm text-gray-400",children:new Date(y.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Z(y.id,y.locked),className:`p-2 rounded-lg transition ${y.locked?"bg-green-500/20 hover:bg-green-500/30 text-green-300":"bg-red-500/20 hover:bg-red-500/30 text-red-300"}`,title:y.locked?"Unlock User":"Lock User",children:y.locked?e.jsx(yt,{className:"w-4 h-4"}):e.jsx(G,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>j(y.id),className:"p-2 rounded-lg bg-blue-500/20 hover:bg-blue-500/30 text-blue-300 transition",title:"Send Payment Reminder",children:e.jsx(Nt,{className:"w-4 h-4"})})]})})]},y.id)})]})]})})})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-purple-900 rounded-2xl shadow-2xl max-w-2xl w-full border border-white/20",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white rounded-t-2xl",children:e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(ye,{}),"Send Email to ",h.length," User(s)"]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Subject"}),e.jsx("input",{type:"text",value:l.subject,onChange:y=>d({...l,subject:y.target.value}),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Email subject..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Message"}),e.jsx("textarea",{value:l.message,onChange:y=>d({...l,message:y.target.value}),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 h-40",placeholder:"Email message..."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>J(h,l.subject,l.message),className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white py-3 rounded-lg font-bold transition",children:"Send Email"}),e.jsx("button",{onClick:()=>f(!1),className:"px-6 py-3 bg-white/10 hover:bg-white/20 text-white rounded-lg font-bold transition",children:"Cancel"})]})]})]})})]})}function Xt(){const{user:t,loading:p}=z();return null}class es extends c.Component{constructor(n){super(n);Ue(this,"handleRetry",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(n){return{hasError:!0}}componentDidCatch(n,m){console.error("ErrorBoundary caught an error:",n,m),this.setState({error:n,errorInfo:m})}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 max-w-md w-full text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(Ne,{className:"w-8 h-8 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"We encountered an unexpected error. Please try refreshing the page or contact support if the problem persists."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:this.handleRetry,className:"w-full flex items-center justify-center gap-2 bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:[e.jsx(vt,{className:"w-4 h-4"}),"Try Again"]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-gray-100 text-gray-700 px-4 py-3 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Refresh Page"})]}),!1]})}):this.props.children}}function Xe(){return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-600 to-purple-600 rounded-2xl mx-auto mb-4 flex items-center justify-center shadow-lg animate-pulse",children:e.jsx("span",{className:"text-2xl font-bold text-white",children:"POS"})}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})})}function X({children:t,adminOnly:p=!1}){const{user:n,loading:m,isInitialized:r}=z();if(!r||m)return e.jsx(Xe,{});if(!n)return e.jsx(W,{to:"/login",replace:!0});if(p){const o=localStorage.getItem("user");let a=n;if(o)try{const f=JSON.parse(o);a={...n,...f}}catch(f){console.warn("Error parsing stored user data:",f)}const x=a.plan==="ultra"||a.role==="admin",u=a.active&&a.plan;if(!x||!u)return console.log("Access denied - User does not have admin privileges:",a),a.plan==="ultra"&&a.role!=="admin"?(a.role="admin",a.active=!0,localStorage.setItem("user",JSON.stringify(a)),window.dispatchEvent(new Event("storage")),t):e.jsx(W,{to:"/cashier",replace:!0})}return t}function ts(){const{user:t,loading:p,isInitialized:n}=z();return!n||p?e.jsx(Xe,{}):t?!t.active||!t.plan?e.jsx(W,{to:"/subscription",replace:!0}):t.plan==="ultra"||t.role==="admin"?e.jsx(W,{to:"/admin",replace:!0}):e.jsx(W,{to:"/cashier",replace:!0}):e.jsx(W,{to:"/login",replace:!0})}function ss(){return e.jsx(es,{children:e.jsx(It,{children:e.jsxs(nt,{children:[e.jsx(Xt,{}),e.jsxs(Me,{children:[e.jsx(F,{path:"/",element:e.jsx(Et,{})}),e.jsx(F,{path:"/login",element:e.jsx(qe,{})}),e.jsx(F,{path:"/signup",element:e.jsx(qe,{})}),e.jsx(F,{path:"/subscription",element:e.jsx(X,{children:e.jsx(Lt,{})})}),e.jsx(F,{path:"/dashboard",element:e.jsx(X,{children:e.jsx(ts,{})})}),e.jsx(F,{path:"/admin/*",element:e.jsx(X,{adminOnly:!0,children:e.jsx(Vt,{})})}),e.jsx(F,{path:"/cashier",element:e.jsx(X,{children:e.jsx(Yt,{})})}),e.jsx(F,{path:"/cashier/settings",element:e.jsx(X,{children:e.jsx(Qt,{})})}),e.jsx(F,{path:"/main.admin",element:e.jsx(Zt,{})})]})]})})})}Se.createRoot(document.getElementById("root")).render(e.jsx(it.StrictMode,{children:e.jsx(ss,{})}));
